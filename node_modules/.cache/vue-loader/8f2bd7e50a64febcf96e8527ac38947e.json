{"remainingRequest":"/Users/marceltanner/Google Drive/Kreativs/Interaktiv/Self Driving/vue_2_selfdriving/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/marceltanner/Google Drive/Kreativs/Interaktiv/Self Driving/vue_2_selfdriving/src/App.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/marceltanner/Google Drive/Kreativs/Interaktiv/Self Driving/vue_2_selfdriving/src/App.vue","mtime":1644165272302},{"path":"/Users/marceltanner/Google Drive/Kreativs/Interaktiv/Self Driving/vue_2_selfdriving/node_modules/cache-loader/dist/cjs.js","mtime":1644164856547},{"path":"/Users/marceltanner/Google Drive/Kreativs/Interaktiv/Self Driving/vue_2_selfdriving/node_modules/babel-loader/lib/index.js","mtime":1644164857550},{"path":"/Users/marceltanner/Google Drive/Kreativs/Interaktiv/Self Driving/vue_2_selfdriving/node_modules/cache-loader/dist/cjs.js","mtime":1644164856547},{"path":"/Users/marceltanner/Google Drive/Kreativs/Interaktiv/Self Driving/vue_2_selfdriving/node_modules/vue-loader/lib/index.js","mtime":1644164857852}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCgpjb25zdCB0ZiA9IHJlcXVpcmUoJ0B0ZW5zb3JmbG93L3RmanMnKTsKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnQXBwJywKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgY3R4OiBudWxsLAogICAgICB3b3JsZFdpZHRoOiAyNTYsCiAgICAgIHdvcmxkSGVpZ2h0OiAyNTYsCiAgICAgIGltZ1dvcmxkOiBudWxsLAogICAgICB3b3JsZExvYWRlZDogZmFsc2UsCiAgICAgIGZwczogbnVsbCwKICAgICAgZnBzQ291bnRlcjogbnVsbCwKICAgICAgdGljazogdHJ1ZSwKICAgICAgdGlja1RpbWU6IG51bGwsCiAgICAgIGNhcjogewogICAgICAgIHdpZHRoOiA4LAogICAgICAgIGxlbmd0aDogMTYsCiAgICAgICAgeDogMjU2IC8gMiAqIDAuMzMzLAogICAgICAgIHk6IDI1NiAvIDIsCiAgICAgICAgc3BlZWQ6IDEsCiAgICAgICAgc3RlZXJpbmdTcGVlZDogMC4wMjUsCiAgICAgICAgYW5nbGU6IDAKICAgICAgfSwKICAgICAgdmlld1NpemU6IDQwLAogICAgICB2aWV3UmVkdWN0aW9uOiAzLAogICAgICBpbnB1dFZhbHVlczogW10sCiAgICAgIHRyYWluaW5nOiBmYWxzZSwKICAgICAgbW9kZWw6IG51bGwKICAgIH0KICB9LAogIGNvbXB1dGVkOiB7CiAgICByZWR1Y2VkVmlld1NpemUoKSB7CiAgICAgIGxldCByZWR1Y2VkU2l6ZSA9IHRoaXMudmlld1NpemU7CiAgICAgIGZvciggbGV0IGkgPSAwOyBpIDwgdGhpcy52aWV3UmVkdWN0aW9uOyBpKysgKSB7CiAgICAgICAgcmVkdWNlZFNpemUgPSByZWR1Y2VkU2l6ZSAvIDI7CiAgICAgIH0KICAgICAgcmV0dXJuIHJlZHVjZWRTaXplOwogICAgfQogIH0sCiAgbW91bnRlZCgpIHsKICAgIHRoaXMuY3R4ID0gdGhpcy4kcmVmcy5jYW52YXMuZ2V0Q29udGV4dCgiMmQiKTsKICAgIHRoaXMuaW1nV29ybGQgPSBuZXcgSW1hZ2UodGhpcy53b3JsZFdpZHRoLHRoaXMud29ybGRIZWlnaHQpOwogICAgdGhpcy5pbWdXb3JsZC5zcmMgPSByZXF1aXJlKCcvc3JjL2Fzc2V0cy93b3JsZC5qcGcnKTsKICAgIGNvbnN0IGFwcCA9IHRoaXM7CiAgICB0aGlzLmltZ1dvcmxkLm9ubG9hZCA9IGZ1bmN0aW9uKCkgewogICAgICBhcHAud29ybGRMb2FkZWQgPSB0cnVlOwogICAgfQogICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMua2V5RG93bik7CiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXl1cCcsIHRoaXMua2V5VXApOwoKICAgIHRoaXMuY3R4Vmlld1NuYXBzaG90ID0gdGhpcy4kcmVmcy52aWV3U25hcHNob3RDYW52YXMuZ2V0Q29udGV4dCgiMmQiKTsKICAgIHRoaXMuY3R4Q2FyU25hcHNob3QgPSB0aGlzLiRyZWZzLmNhclNuYXBzaG90Q2FudmFzLmdldENvbnRleHQoIjJkIik7CgogICAgdGhpcy5jdHhDYXIgPSB0aGlzLiRyZWZzLmNhckNhbnZhcy5nZXRDb250ZXh0KCIyZCIpOwogICAgdGhpcy5jdHhWaWV3ID0gdGhpcy4kcmVmcy52aWV3Q2FudmFzLmdldENvbnRleHQoIjJkIik7CiAgICB0aGlzLmN0eFZpZXdSZWR1Y2VkID0gdGhpcy4kcmVmcy52aWV3Q2FudmFzUmVkdWNlZC5nZXRDb250ZXh0KCIyZCIpOwoKICAgIHRoaXMucmVmcmVzaExvb3AoKTsKICB9LAogIG1ldGhvZHM6IHsKICAgIHJlZnJlc2hMb29wKCkgewogICAgICB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+IHsKICAgICAgICBjb25zdCBub3cgPSBwZXJmb3JtYW5jZS5ub3coKTsKICAgICAgICBpZiggdGhpcy50aWNrICkgewogICAgICAgICAgdGhpcy50aWNrVGltZSA9IG5vdzsKICAgICAgICAgIHRoaXMuZnBzID0gdGhpcy5mcHNDb3VudGVyOwogICAgICAgICAgdGhpcy5mcHNDb3VudGVyID0gMDsKICAgICAgICAgIHRoaXMudGljayA9IGZhbHNlOwogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgIHRoaXMuZnBzQ291bnRlcisrOwogICAgICAgICAgaWYoIG5vdyA+PSB0aGlzLnRpY2tUaW1lICsgMTAwMCApIHsKICAgICAgICAgICAgdGhpcy50aWNrID0gdHJ1ZTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHRoaXMuZW50ZXJGcmFtZSgpOwoKICAgICAgICB0aGlzLnJlZnJlc2hMb29wKCk7CiAgICAgIH0pOwogICAgfSwKICAgIGVudGVyRnJhbWUoKSB7CiAgICAgIGlmKCB0aGlzLndvcmxkTG9hZGVkICYmICF0aGlzLnRyYWluaW5nICkgewogICAgICAgIHRoaXMuZHJhd1dvcmxkKCk7CiAgICAgICAgdGhpcy5jYWxjdWxhdGUoKTsKICAgICAgICB0aGlzLmRyYXdDYXIoKTsKICAgICAgfQogICAgfSwKICAgIGFzeW5jIHRyYWluKCkgewogICAgICB0aGlzLnRyYWluaW5nID0gdHJ1ZTsKCiAgICAgIGNvbnN0IGZlYXR1cmVWYWx1ZXNUcmFpbmluZyA9ICBbIFswLjUsMC41LDAuNV0gXTsKICAgICAgY29uc3QgZmVhdHVyZVRlbnNvclRyYWluaW5nID0gdGYudGVuc29yMmQoIGZlYXR1cmVWYWx1ZXNUcmFpbmluZywgWzEsIDNdICk7CgogICAgICBjb25zdCBsYWJlbFZhbHVlc1RyYWluaW5nID0gIFsgWzAuNSwwLjVdIF07CiAgICAgIGNvbnN0IGxhYmVsVGVuc29yVHJhaW5pbmcgPSB0Zi50ZW5zb3IyZCggbGFiZWxWYWx1ZXNUcmFpbmluZywgW2xhYmVsVmFsdWVzVHJhaW5pbmcubGVuZ3RoLCAyXSApOwoKICAgICAgY29uc29sZS5sb2coImNyZWF0aW5nIG1vZGVsIC4uLiIpOwogICAgICB0aGlzLm1vZGVsID0gdGYuc2VxdWVudGlhbCgpOwogICAgICB0aGlzLm1vZGVsLmFkZCh0Zi5sYXllcnMuZGVuc2Uoe2lucHV0U2hhcGU6IDMsIGFjdGl2YXRpb246ICJzaWdtb2lkIiwgdW5pdHM6IDV9KSk7CiAgICAgIHRoaXMubW9kZWwuYWRkKHRmLmxheWVycy5kZW5zZSh7YWN0aXZhdGlvbjogInJlbHUiLCB1bml0czogMTB9KSk7CiAgICAgIHRoaXMubW9kZWwuYWRkKHRmLmxheWVycy5kZW5zZSh7YWN0aXZhdGlvbjogInNpZ21vaWQiLCB1bml0czogMn0pKTsKICAgICAgLy90aGlzLm1vZGVsLmNvbXBpbGUoe2xvc3M6J2JpbmFyeUNyb3NzZW50cm9weScsb3B0aW1pemVyOnRmLnRyYWluLnJtc3Byb3AoMC4xKSxtZXRyaWNzOlsnYWNjdXJhY3knXX0pOwogICAgICB0aGlzLm1vZGVsLmNvbXBpbGUoe2xvc3M6J2NhdGVnb3JpY2FsQ3Jvc3NlbnRyb3B5JyxvcHRpbWl6ZXI6dGYudHJhaW4uYWRhbSgpLG1ldHJpY3M6WydhY2N1cmFjeSddfSk7CgogICAgICBhd2FpdCB0aGlzLnRyYWluTW9kZWwoIGZlYXR1cmVUZW5zb3JUcmFpbmluZywgbGFiZWxUZW5zb3JUcmFpbmluZyApOwoKICAgICAgY29uc3QgZmVhdHVyZVZhbHVlc1Rlc3RpbmcgPSAgWyBbMC41LDAuNSwwLjVdIF07CiAgICAgIC8vY29uc29sZS5sb2coIGF3YWl0IHRoaXMucHJlZGljdChmZWF0dXJlVmFsdWVzVGVzdGluZykgKTsKCiAgICAgIHRoaXMudHJhaW5pbmcgPSBmYWxzZTsKICAgIH0sCiAgICBhc3luYyB0cmFpbk1vZGVsKCBmZWF0dXJlVGVuc29yVHJhaW5pbmcsIGxhYmVsVGVuc29yVHJhaW5pbmcgKSB7CiAgICAgIHJldHVybiB0aGlzLm1vZGVsLmZpdCggZmVhdHVyZVRlbnNvclRyYWluaW5nLCBsYWJlbFRlbnNvclRyYWluaW5nLCB7CiAgICAgICAgZXBvY2hzOiAxMCwKICAgICAgICAvL3ZhbGlkYXRpb25TcGxpdDogMC4yLAogICAgICAgIGNhbGxiYWNrczogewogICAgICAgICAgb25FcG9jaEVuZDogZnVuY3Rpb24oZXBvY2gpIHsKICAgICAgICAgICAgLy9wcmVkaWN0KCBmZWF0dXJlVmFsdWVzVGVzdGluZ1swXSApOwogICAgICAgICAgICBjb25zb2xlLmxvZygiZXBvY2ggIitlcG9jaCkKICAgICAgICAgIH0sCiAgICAgICAgICBvblRyYWluRW5kOiBmdW5jdGlvbigpIHsKICAgICAgICAgICAgY29uc29sZS5sb2coImRvbmUiKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIGFzeW5jIHByZWRpY3QoIGlucHV0ICkgewogICAgICByZXR1cm4gdGYudGlkeSggKCkgPT4gewogICAgICAgIGNvbnN0IGlucHV0VGVuc29yID0gdGYudGVuc29yMmQoW2lucHV0XSxbMSwgM10pOwogICAgICAgIGNvbnN0IG91dHB1dFRlbnNvciA9IHRoaXMubW9kZWwucHJlZGljdCggaW5wdXRUZW5zb3IgKTsKICAgICAgICBjb25zdCBvdXRwdXRWYWx1ZSA9IG91dHB1dFRlbnNvci5kYXRhU3luYygpOwoKICAgICAgICByZXR1cm4gb3V0cHV0VmFsdWU7CiAgICAgIH0pOwogICAgfSwKICAgIGNhbGN1bGF0ZSgpIHsKICAgICAgaWYoIHRoaXMuY2FyLnN0ZWVyaW5nICkgewogICAgICAgIGlmKCB0aGlzLmNhci5zdGVlcmluZyA9PT0gImxlZnQiICkgewogICAgICAgICAgdGhpcy5jYXIuYW5nbGUgLT0gdGhpcy5jYXIuc3RlZXJpbmdTcGVlZDsKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICB0aGlzLmNhci5hbmdsZSArPSB0aGlzLmNhci5zdGVlcmluZ1NwZWVkOwogICAgICAgIH0KICAgICAgfQogICAgICB0aGlzLmNhci54ICs9IE1hdGguc2luKCB0aGlzLmNhci5hbmdsZSApICp0aGlzLmNhci5zcGVlZDsKICAgICAgdGhpcy5jYXIueSAtPSBNYXRoLmNvcyggdGhpcy5jYXIuYW5nbGUgKSAqdGhpcy5jYXIuc3BlZWQ7CiAgICB9LAogICAgZHJhd1dvcmxkKCkgewogICAgICB0aGlzLmN0eC5jbGVhclJlY3QoIDAsIDAsIHRoaXMuY3R4LmNhbnZhcy53aWR0aCwgdGhpcy5jdHguY2FudmFzLmhlaWdodCApOwogICAgICB0aGlzLmN0eC5kcmF3SW1hZ2UoIHRoaXMuaW1nV29ybGQsIDAsIDAsIHRoaXMuY3R4LmNhbnZhcy53aWR0aCwgdGhpcy5jdHguY2FudmFzLmhlaWdodCApOwogICAgfSwKICAgIGNvbXBvbmVudFRvSGV4KGMpIHsKICAgICAgdmFyIGhleCA9IGMudG9TdHJpbmcoMTYpOwogICAgICByZXR1cm4gaGV4Lmxlbmd0aCA9PSAxID8gIjAiICsgaGV4IDogaGV4OwogICAgfSwKICAgIHJnYlRvSGV4KHIsIGcsIGIpIHsKICAgICAgcmV0dXJuICIjIiArIHRoaXMuY29tcG9uZW50VG9IZXgocikgKyB0aGlzLmNvbXBvbmVudFRvSGV4KGcpICsgdGhpcy5jb21wb25lbnRUb0hleChiKTsKICAgIH0sCiAgICByZWR1Y2VQaXhlbHMocGl4ZWxzLHNpemUpIHsKICAgICAgLy8gcmVkdWNlIHJlc29sdXRpb24KICAgICAgbGV0IHBpeGVsc1JlZHVjZWQgPSBbXTsKICAgICAgZm9yKCBsZXQgeSA9IDA7IHkgPCBzaXplOyB5Kz0yICkgewogICAgICAgIGZvciggbGV0IHggPSAwOyB4IDwgc2l6ZTsgeCs9MiApIHsKICAgICAgICAgIGNvbnN0IHBpeGVsSW5kZXhlcyA9IFsKICAgICAgICAgICAgeSpzaXplICsgeCwKICAgICAgICAgICAgeSpzaXplICsgeCArMSwKICAgICAgICAgICAgKHkrMSkqc2l6ZSArIHgsCiAgICAgICAgICAgICh5KzEpKnNpemUgKyB4ICsxLAogICAgICAgICAgXTsKCiAgICAgICAgICBsZXQgdG90YWxSID0gMDsKICAgICAgICAgIGxldCB0b3RhbEcgPSAwOwogICAgICAgICAgbGV0IHRvdGFsQiA9IDA7CiAgICAgICAgICBmb3IoIGxldCBpID0gMDsgaSA8IHBpeGVsSW5kZXhlcy5sZW5ndGg7IGkrKyApIHsKICAgICAgICAgICAgdG90YWxSICs9IHBpeGVsc1twaXhlbEluZGV4ZXNbaV1dWzBdOwogICAgICAgICAgICB0b3RhbEcgKz0gcGl4ZWxzW3BpeGVsSW5kZXhlc1tpXV1bMV07CiAgICAgICAgICAgIHRvdGFsQiArPSBwaXhlbHNbcGl4ZWxJbmRleGVzW2ldXVsyXTsKICAgICAgICAgIH0KICAgICAgICAgIHRvdGFsUiA9IE1hdGgucm91bmQoIHRvdGFsUiAvIHBpeGVsSW5kZXhlcy5sZW5ndGggKTsKICAgICAgICAgIHRvdGFsRyA9IE1hdGgucm91bmQoIHRvdGFsRyAvIHBpeGVsSW5kZXhlcy5sZW5ndGggKTsKICAgICAgICAgIHRvdGFsQiA9IE1hdGgucm91bmQoIHRvdGFsQiAvIHBpeGVsSW5kZXhlcy5sZW5ndGggKTsKICAgICAgICAgIHBpeGVsc1JlZHVjZWQucHVzaCggW3RvdGFsUix0b3RhbEcsdG90YWxCXSApOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gcGl4ZWxzUmVkdWNlZDsKICAgIH0sCiAgICBkcmF3Q2FyKCkgewoKICAgICAgLy8gZ2V0IGNhciBpbWFnZQogICAgICB0aGlzLnNuYXBzaG90V2hlcmVDYXJJcyA9IHRoaXMuY3R4LmdldEltYWdlRGF0YSggdGhpcy5jYXIueCAtIHRoaXMuY3R4Q2FyU25hcHNob3QuY2FudmFzLndpZHRoLzIsIHRoaXMuY2FyLnkgLSB0aGlzLmN0eENhclNuYXBzaG90LmNhbnZhcy5oZWlnaHQvMiwgdGhpcy5jdHhDYXJTbmFwc2hvdC5jYW52YXMud2lkdGgsIHRoaXMuY3R4Q2FyU25hcHNob3QuY2FudmFzLmhlaWdodCApOwoKICAgICAgLy8gcmVhZCBwaXhlbHMKICAgICAgbGV0IGNhclNuYXBzaG90UGl4ZWxzID0gW107CiAgICAgIGZvciggbGV0IGkgPSAwOyBpIDwgdGhpcy5zbmFwc2hvdFdoZXJlQ2FySXMuZGF0YS5sZW5ndGg7IGkgKz0gNCApIHsKICAgICAgICBjb25zdCByID0gdGhpcy5zbmFwc2hvdFdoZXJlQ2FySXMuZGF0YVtpXTsKICAgICAgICBjb25zdCBnID0gdGhpcy5zbmFwc2hvdFdoZXJlQ2FySXMuZGF0YVtpKzFdOwogICAgICAgIGNvbnN0IGIgPSB0aGlzLnNuYXBzaG90V2hlcmVDYXJJcy5kYXRhW2krMl07CgogICAgICAgIGNhclNuYXBzaG90UGl4ZWxzLnB1c2goIFtyLGcsYl0gKTsKICAgICAgfQoKICAgICAgLy8gZHJhdyByb3RhdGVkIGltYWdlCiAgICAgIHRoaXMuY3R4Q2FyU25hcHNob3Quc2F2ZSgpOwogICAgICB0aGlzLmN0eENhclNuYXBzaG90LmNsZWFyUmVjdCggMCwgMCwgdGhpcy5jdHhDYXJTbmFwc2hvdC5jYW52YXMud2lkdGgsIHRoaXMuY3R4Q2FyU25hcHNob3QuY2FudmFzLmhlaWdodCApOwogICAgICB0aGlzLmN0eENhclNuYXBzaG90LnRyYW5zbGF0ZSggdGhpcy5jdHhDYXJTbmFwc2hvdC5jYW52YXMud2lkdGgvMiwgdGhpcy5jdHhDYXJTbmFwc2hvdC5jYW52YXMuaGVpZ2h0LzIgKTsKICAgICAgdGhpcy5jdHhDYXJTbmFwc2hvdC5yb3RhdGUoIC10aGlzLmNhci5hbmdsZSApOwogICAgICB0aGlzLmN0eENhclNuYXBzaG90LnRyYW5zbGF0ZSggLXRoaXMuY3R4Q2FyU25hcHNob3QuY2FudmFzLndpZHRoLzIsIC10aGlzLmN0eENhclNuYXBzaG90LmNhbnZhcy5oZWlnaHQvMiApOwogICAgICBmb3IoIGxldCB5ID0gMDsgeSA8IHRoaXMuY3R4Q2FyU25hcHNob3QuY2FudmFzLmhlaWdodDsgeSsrICkgewogICAgICAgIGZvciggbGV0IHggPSAwOyB4IDwgdGhpcy5jdHhDYXJTbmFwc2hvdC5jYW52YXMud2lkdGg7IHgrKyApIHsKICAgICAgICAgIGNvbnN0IHBpeGVsSW5kZXggPSB5KnRoaXMuY3R4Q2FyU25hcHNob3QuY2FudmFzLndpZHRoICsgeDsKICAgICAgICAgIGNvbnN0IGNvbG9yID0gdGhpcy5yZ2JUb0hleCggY2FyU25hcHNob3RQaXhlbHNbcGl4ZWxJbmRleF1bMF0sIGNhclNuYXBzaG90UGl4ZWxzW3BpeGVsSW5kZXhdWzFdLCBjYXJTbmFwc2hvdFBpeGVsc1twaXhlbEluZGV4XVsyXSApOwogICAgICAgICAgdGhpcy5jdHhDYXJTbmFwc2hvdC5maWxsU3R5bGUgPSBjb2xvcjsKICAgICAgICAgIHRoaXMuY3R4Q2FyU25hcHNob3QuZmlsbFJlY3QoIHgsIHksIDEuNSwgMS41ICk7CiAgICAgICAgfQogICAgICB9CiAgICAgIHRoaXMuY3R4Q2FyU25hcHNob3QucmVzdG9yZSgpOwoKCiAgICAgIC8vIGdldCBjYXIgaW1hZ2UKICAgICAgdGhpcy5pbWdXaGVyZUNhcklzID0gdGhpcy5jdHhDYXJTbmFwc2hvdC5nZXRJbWFnZURhdGEoIHRoaXMuY3R4Q2FyU25hcHNob3QuY2FudmFzLndpZHRoLzIgLSB0aGlzLmN0eENhci5jYW52YXMud2lkdGgvMiwgdGhpcy5jdHhDYXJTbmFwc2hvdC5jYW52YXMuaGVpZ2h0LzIgLSB0aGlzLmN0eENhci5jYW52YXMuaGVpZ2h0LzIsIHRoaXMuY3R4Q2FyLmNhbnZhcy53aWR0aCwgdGhpcy5jdHhDYXIuY2FudmFzLmhlaWdodCApOwogICAgICB0aGlzLmN0eENhci5wdXRJbWFnZURhdGEodGhpcy5pbWdXaGVyZUNhcklzLCAwLCAwKTsKCgogICAgICAvLyByZWFkIHBpeGVscwogICAgICBsZXQgdG90YWxSID0gMDsKICAgICAgbGV0IHRvdGFsRyA9IDA7CiAgICAgIGxldCB0b3RhbEIgPSAwOwogICAgICBmb3IoIGxldCBpID0gMDsgaSA8IHRoaXMuaW1nV2hlcmVDYXJJcy5kYXRhLmxlbmd0aDsgaSArPSA0ICkgewogICAgICAgIHRvdGFsUiArPSB0aGlzLmltZ1doZXJlQ2FySXMuZGF0YVtpXTsKICAgICAgICB0b3RhbEcgKz0gdGhpcy5pbWdXaGVyZUNhcklzLmRhdGFbaSsxXTsKICAgICAgICB0b3RhbEIgKz0gdGhpcy5pbWdXaGVyZUNhcklzLmRhdGFbaSsyXTsKICAgICAgfQogICAgICB0b3RhbFIgPSBNYXRoLnJvdW5kKCB0b3RhbFIgLyAodGhpcy5pbWdXaGVyZUNhcklzLmRhdGEubGVuZ3RoIC80KSApOwogICAgICB0b3RhbEcgPSBNYXRoLnJvdW5kKCB0b3RhbEcgLyAodGhpcy5pbWdXaGVyZUNhcklzLmRhdGEubGVuZ3RoIC80KSApOwogICAgICB0b3RhbEIgPSBNYXRoLnJvdW5kKCB0b3RhbEIgLyAodGhpcy5pbWdXaGVyZUNhcklzLmRhdGEubGVuZ3RoIC80KSApOwogICAgICBpZiggdG90YWxSICsgdG90YWxHICsgdG90YWxCIDwgNzYwICkgewogICAgICAgIGNvbnNvbGUubG9nKCJjb2xsaXNpb24iKTsKCiAgICAgICAgdGhpcy5pbnB1dFZhbHVlcyA9IFtdOwogICAgICAgIHRoaXMucmVzdGFydCgpOwoKCiAgICAgICAgdGhpcy50cmFpbigpOwoKICAgICAgfQoKCgoKICAgICAgLy8gdmlldwoKICAgICAgY29uc3Qgdmlld1ggPSB0aGlzLmNhci54ICsgTWF0aC5zaW4oIHRoaXMuY2FyLmFuZ2xlICkgKiAodGhpcy5jYXIubGVuZ3RoLzIrdGhpcy52aWV3U2l6ZS8yKTsKICAgICAgY29uc3Qgdmlld1kgPSB0aGlzLmNhci55IC0gTWF0aC5jb3MoIHRoaXMuY2FyLmFuZ2xlICkgKiAodGhpcy5jYXIubGVuZ3RoLzIrdGhpcy52aWV3U2l6ZS8yKTsKCgogICAgICAvLyBnZXQgdmlldyBpbWFnZQogICAgICB0aGlzLnNuYXBzaG90V2hlcmVWaWV3SXMgPSB0aGlzLmN0eC5nZXRJbWFnZURhdGEoIHZpZXdYIC0gdGhpcy5jdHhWaWV3U25hcHNob3QuY2FudmFzLndpZHRoLzIsIHZpZXdZIC0gdGhpcy5jdHhWaWV3U25hcHNob3QuY2FudmFzLmhlaWdodC8yLCB0aGlzLmN0eFZpZXdTbmFwc2hvdC5jYW52YXMud2lkdGgsIHRoaXMuY3R4Vmlld1NuYXBzaG90LmNhbnZhcy5oZWlnaHQgKTsKCiAgICAgIC8vIHJlYWQgcGl4ZWxzCiAgICAgIGxldCB2aWV3U25hcHNob3RQaXhlbHMgPSBbXTsKICAgICAgZm9yKCBsZXQgaSA9IDA7IGkgPCB0aGlzLnNuYXBzaG90V2hlcmVWaWV3SXMuZGF0YS5sZW5ndGg7IGkgKz0gNCApIHsKICAgICAgICBjb25zdCByID0gdGhpcy5zbmFwc2hvdFdoZXJlVmlld0lzLmRhdGFbaV07CiAgICAgICAgY29uc3QgZyA9IHRoaXMuc25hcHNob3RXaGVyZVZpZXdJcy5kYXRhW2krMV07CiAgICAgICAgY29uc3QgYiA9IHRoaXMuc25hcHNob3RXaGVyZVZpZXdJcy5kYXRhW2krMl07CgogICAgICAgIHZpZXdTbmFwc2hvdFBpeGVscy5wdXNoKCBbcixnLGJdICk7CiAgICAgIH0KCgogICAgICAvLyBkcmF3IHJvdGF0ZWQgaW1hZ2UKICAgICAgdGhpcy5jdHhWaWV3U25hcHNob3Quc2F2ZSgpOwogICAgICB0aGlzLmN0eFZpZXdTbmFwc2hvdC5jbGVhclJlY3QoIDAsIDAsIHRoaXMuY3R4Vmlld1NuYXBzaG90LmNhbnZhcy53aWR0aCwgdGhpcy5jdHhWaWV3U25hcHNob3QuY2FudmFzLmhlaWdodCApOwogICAgICB0aGlzLmN0eFZpZXdTbmFwc2hvdC50cmFuc2xhdGUoIHRoaXMuY3R4Vmlld1NuYXBzaG90LmNhbnZhcy53aWR0aC8yLCB0aGlzLmN0eFZpZXdTbmFwc2hvdC5jYW52YXMuaGVpZ2h0LzIgKTsKICAgICAgdGhpcy5jdHhWaWV3U25hcHNob3Qucm90YXRlKCAtdGhpcy5jYXIuYW5nbGUgKTsKICAgICAgdGhpcy5jdHhWaWV3U25hcHNob3QudHJhbnNsYXRlKCAtdGhpcy5jdHhWaWV3U25hcHNob3QuY2FudmFzLndpZHRoLzIsIC10aGlzLmN0eFZpZXdTbmFwc2hvdC5jYW52YXMuaGVpZ2h0LzIgKTsKICAgICAgZm9yKCBsZXQgeSA9IDA7IHkgPCB0aGlzLmN0eFZpZXdTbmFwc2hvdC5jYW52YXMuaGVpZ2h0OyB5KysgKSB7CiAgICAgICAgZm9yKCBsZXQgeCA9IDA7IHggPCB0aGlzLmN0eFZpZXdTbmFwc2hvdC5jYW52YXMud2lkdGg7IHgrKyApIHsKICAgICAgICAgIGNvbnN0IHBpeGVsSW5kZXggPSB5KnRoaXMuY3R4Vmlld1NuYXBzaG90LmNhbnZhcy53aWR0aCArIHg7CiAgICAgICAgICBjb25zdCBjb2xvciA9IHRoaXMucmdiVG9IZXgoIHZpZXdTbmFwc2hvdFBpeGVsc1twaXhlbEluZGV4XVswXSwgdmlld1NuYXBzaG90UGl4ZWxzW3BpeGVsSW5kZXhdWzFdLCB2aWV3U25hcHNob3RQaXhlbHNbcGl4ZWxJbmRleF1bMl0gKTsKICAgICAgICAgIHRoaXMuY3R4Vmlld1NuYXBzaG90LmZpbGxTdHlsZSA9IGNvbG9yOwogICAgICAgICAgdGhpcy5jdHhWaWV3U25hcHNob3QuZmlsbFJlY3QoIHgsIHksIDEuNSwgMS41ICk7CiAgICAgICAgfQogICAgICB9CiAgICAgIHRoaXMuY3R4Vmlld1NuYXBzaG90LnJlc3RvcmUoKTsKCiAgICAgIC8vIGdldCB2aWV3IGltYWdlCiAgICAgIHRoaXMuaW1nV2hlcmVWaWV3SXMgPSB0aGlzLmN0eFZpZXdTbmFwc2hvdC5nZXRJbWFnZURhdGEoIHRoaXMuY3R4Vmlld1NuYXBzaG90LmNhbnZhcy53aWR0aC8yIC0gdGhpcy5jdHhWaWV3LmNhbnZhcy53aWR0aC8yLCB0aGlzLmN0eFZpZXdTbmFwc2hvdC5jYW52YXMuaGVpZ2h0LzIgLSB0aGlzLmN0eFZpZXcuY2FudmFzLmhlaWdodC8yLCB0aGlzLmN0eFZpZXcuY2FudmFzLndpZHRoLCB0aGlzLmN0eFZpZXcuY2FudmFzLmhlaWdodCApOwogICAgICB0aGlzLmN0eFZpZXcucHV0SW1hZ2VEYXRhKHRoaXMuaW1nV2hlcmVWaWV3SXMsIDAsIDApOwoKICAgICAgLy8gcmVhZCBwaXhlbHMKICAgICAgbGV0IHZpZXdQaXhlbHMgPSBbXTsKICAgICAgZm9yKCBsZXQgaSA9IDA7IGkgPCB0aGlzLmltZ1doZXJlVmlld0lzLmRhdGEubGVuZ3RoOyBpICs9IDQgKSB7CiAgICAgICAgY29uc3QgciA9IHRoaXMuaW1nV2hlcmVWaWV3SXMuZGF0YVtpXTsKICAgICAgICBjb25zdCBnID0gdGhpcy5pbWdXaGVyZVZpZXdJcy5kYXRhW2krMV07CiAgICAgICAgY29uc3QgYiA9IHRoaXMuaW1nV2hlcmVWaWV3SXMuZGF0YVtpKzJdOwogICAgICAgIHZpZXdQaXhlbHMucHVzaCggW3IsZyxiXSApOwogICAgICB9CgoKICAgICAgbGV0IHZpZXdQaXhlbHNSZWR1Y2VkID0gdmlld1BpeGVsczsKICAgICAgZm9yKCBsZXQgaSA9IDA7IGkgPCB0aGlzLnZpZXdSZWR1Y3Rpb247IGkrKyApIHsKICAgICAgICB2aWV3UGl4ZWxzUmVkdWNlZCA9IHRoaXMucmVkdWNlUGl4ZWxzKCB2aWV3UGl4ZWxzUmVkdWNlZCwgTWF0aC5zcXJ0KHZpZXdQaXhlbHNSZWR1Y2VkLmxlbmd0aCkgKTsKICAgICAgfQoKICAgICAgdGhpcy5pbnB1dFZhbHVlcy51bnNoaWZ0KHZpZXdQaXhlbHNSZWR1Y2VkKTsKICAgICAgdGhpcy5pbnB1dFZhbHVlcyA9IHRoaXMuaW5wdXRWYWx1ZXMuc2xpY2UoMCwxNik7CgogICAgICAvLyBkcmF3IHJlZHVjZWQgdmlldwogICAgICBmb3IoIGxldCB5ID0gMDsgeSA8IHRoaXMuY3R4Vmlld1JlZHVjZWQuY2FudmFzLmhlaWdodDsgeSsrICkgewogICAgICAgIGZvciggbGV0IHggPSAwOyB4IDwgdGhpcy5jdHhWaWV3UmVkdWNlZC5jYW52YXMud2lkdGg7IHgrKyApIHsKICAgICAgICAgIGNvbnN0IHBpeGVsSW5kZXggPSB5KnRoaXMuY3R4Vmlld1JlZHVjZWQuY2FudmFzLndpZHRoICsgeDsKICAgICAgICAgIGNvbnN0IGNvbG9yID0gdGhpcy5yZ2JUb0hleCggdmlld1BpeGVsc1JlZHVjZWRbcGl4ZWxJbmRleF1bMF0sIHZpZXdQaXhlbHNSZWR1Y2VkW3BpeGVsSW5kZXhdWzFdLCB2aWV3UGl4ZWxzUmVkdWNlZFtwaXhlbEluZGV4XVsyXSApOwogICAgICAgICAgdGhpcy5jdHhWaWV3UmVkdWNlZC5maWxsU3R5bGUgPSBjb2xvcjsKICAgICAgICAgIHRoaXMuY3R4Vmlld1JlZHVjZWQuZmlsbFJlY3QoIHgsIHksIDEuNSwgMS41ICk7CiAgICAgICAgfQogICAgICB9CgoKICAgICAgLy8gZHJhdyBjYXIKICAgICAgdGhpcy5jdHguc2F2ZSgpOwogICAgICB0aGlzLmN0eC50cmFuc2xhdGUoIHRoaXMuY2FyLngsIHRoaXMuY2FyLnkgKTsKICAgICAgdGhpcy5jdHgucm90YXRlKCB0aGlzLmNhci5hbmdsZSApOwogICAgICB0aGlzLmN0eC50cmFuc2xhdGUoIC10aGlzLmNhci54LCAtdGhpcy5jYXIueSApOwogICAgICB0aGlzLmN0eC5maWxsUmVjdCggdGhpcy5jYXIueCAtdGhpcy5jYXIud2lkdGgvMiwgdGhpcy5jYXIueSAtdGhpcy5jYXIubGVuZ3RoLzIsIHRoaXMuY2FyLndpZHRoLCB0aGlzLmNhci5sZW5ndGggKTsKICAgICAgdGhpcy5jdHgucmVzdG9yZSgpOwoKCiAgICAgIC8qCgogICAgICAvLyBkcmF3IHZpZXcgc25hcHNob3QgcmVjdAogICAgICB0aGlzLmN0eC5zYXZlKCk7CiAgICAgIHRoaXMuY3R4LnN0cm9rZVN0eWxlID0gIiNmZjAwMDAiOwogICAgICB0aGlzLmN0eC5iZWdpblBhdGgoKTsKICAgICAgdGhpcy5jdHgucmVjdCggdmlld1ggLXRoaXMuY3R4Vmlld1NuYXBzaG90LmNhbnZhcy53aWR0aC8yLCB2aWV3WSAtdGhpcy5jdHhWaWV3U25hcHNob3QuY2FudmFzLmhlaWdodC8yLCB0aGlzLmN0eFZpZXdTbmFwc2hvdC5jYW52YXMud2lkdGgsIHRoaXMuY3R4Vmlld1NuYXBzaG90LmNhbnZhcy5oZWlnaHQgKTsKICAgICAgdGhpcy5jdHguc3Ryb2tlKCk7CiAgICAgIHRoaXMuY3R4LnJlc3RvcmUoKTsKICAgICAgKi8KCgogICAgICAvLyBkcmF3IHZpZXcgcmVjdAogICAgICB0aGlzLmN0eC5zYXZlKCk7CiAgICAgIHRoaXMuY3R4LnRyYW5zbGF0ZSggdmlld1gsIHZpZXdZICk7CiAgICAgIHRoaXMuY3R4LnJvdGF0ZSggdGhpcy5jYXIuYW5nbGUgKTsKICAgICAgdGhpcy5jdHgudHJhbnNsYXRlKCAtdmlld1gsIC12aWV3WSApOwogICAgICB0aGlzLmN0eC5zdHJva2VTdHlsZSA9ICIjZmYwMDAwIjsKICAgICAgdGhpcy5jdHguYmVnaW5QYXRoKCk7CiAgICAgIHRoaXMuY3R4LnJlY3QoIHZpZXdYIC10aGlzLmN0eFZpZXcuY2FudmFzLndpZHRoLzIsIHZpZXdZIC10aGlzLmN0eFZpZXcuY2FudmFzLmhlaWdodC8yLCB0aGlzLmN0eFZpZXcuY2FudmFzLndpZHRoLCB0aGlzLmN0eFZpZXcuY2FudmFzLmhlaWdodCApOwogICAgICB0aGlzLmN0eC5zdHJva2UoKTsKICAgICAgdGhpcy5jdHgucmVzdG9yZSgpOwoKICAgIH0sCiAgICByZXN0YXJ0KCkgewogICAgICBjb25zb2xlLmxvZyggInJlc3RhcnQgIik7CiAgICAgIHRoaXMuY2FyLnggPSB0aGlzLndvcmxkV2lkdGggLyAyICogMC4zMzM7CiAgICAgIHRoaXMuY2FyLnkgPSB0aGlzLndvcmxkSGVpZ2h0IC8gMjsKICAgICAgdGhpcy5jYXIuYW5nbGUgPSAwOwogICAgfSwKICAgIGtleURvd24oZSkgewogICAgICBpZiggZS5jb2RlID09PSAiQXJyb3dMZWZ0IiApIHsKICAgICAgICB0aGlzLmNhci5zdGVlcmluZyA9ICJsZWZ0IjsKICAgICAgfQogICAgICBlbHNlIGlmKCBlLmNvZGUgPT09ICJBcnJvd1JpZ2h0IiApIHsKICAgICAgICB0aGlzLmNhci5zdGVlcmluZyA9ICJyaWdodCI7CiAgICAgIH0KICAgIH0sCiAgICBrZXlVcChlKSB7CiAgICAgIGlmKCBlLmNvZGUgPT09ICJBcnJvd0xlZnQiICkgewogICAgICAgIHRoaXMuY2FyLnN0ZWVyaW5nID0gdW5kZWZpbmVkOwogICAgICB9CiAgICAgIGVsc2UgaWYoIGUuY29kZSA9PT0gIkFycm93UmlnaHQiICkgewogICAgICAgIHRoaXMuY2FyLnN0ZWVyaW5nID0gdW5kZWZpbmVkOwogICAgICB9CiAgICB9CiAgfQp9Cg=="},{"version":3,"sources":["App.vue"],"names":[],"mappings":";;;;;;;;;;;;;;AAcA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;;AAEA;;;;;AAKA;;AAEA;AACA;;;AAGA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"App.vue","sourceRoot":"src","sourcesContent":["<template>\n  <div class=\"world\">\n    <canvas ref=\"canvas\" :width=\"worldWidth\" :height=\"worldHeight\"></canvas>\n  </div>\n  <canvas class=\"car-snapshot-canvas\" ref=\"carSnapshotCanvas\" :width=\"car.length*1.5\" :height=\"car.length*1.5\"></canvas>\n  <canvas class=\"view-snapshot-canvas\" ref=\"viewSnapshotCanvas\" :width=\"viewSize*1.5\" :height=\"viewSize*1.5\"></canvas>\n  <canvas class=\"car-canvas\" ref=\"carCanvas\" :width=\"car.width\" :height=\"car.length\"></canvas>\n  <canvas class=\"view-canvas\" ref=\"viewCanvas\" :width=\"viewSize\" :height=\"viewSize\"></canvas>\n  <canvas class=\"view-canvas-reduced\" ref=\"viewCanvasReduced\" :width=\"reducedViewSize\" :height=\"reducedViewSize\"></canvas>\n  <span class=\"fps\">{{ fps }} fps</span>\n</template>\n\n<script>\n\nconst tf = require('@tensorflow/tfjs');\n\nexport default {\n  name: 'App',\n  data() {\n    return {\n      ctx: null,\n      worldWidth: 256,\n      worldHeight: 256,\n      imgWorld: null,\n      worldLoaded: false,\n      fps: null,\n      fpsCounter: null,\n      tick: true,\n      tickTime: null,\n      car: {\n        width: 8,\n        length: 16,\n        x: 256 / 2 * 0.333,\n        y: 256 / 2,\n        speed: 1,\n        steeringSpeed: 0.025,\n        angle: 0\n      },\n      viewSize: 40,\n      viewReduction: 3,\n      inputValues: [],\n      training: false,\n      model: null\n    }\n  },\n  computed: {\n    reducedViewSize() {\n      let reducedSize = this.viewSize;\n      for( let i = 0; i < this.viewReduction; i++ ) {\n        reducedSize = reducedSize / 2;\n      }\n      return reducedSize;\n    }\n  },\n  mounted() {\n    this.ctx = this.$refs.canvas.getContext(\"2d\");\n    this.imgWorld = new Image(this.worldWidth,this.worldHeight);\n    this.imgWorld.src = require('/src/assets/world.jpg');\n    const app = this;\n    this.imgWorld.onload = function() {\n      app.worldLoaded = true;\n    }\n    document.addEventListener('keydown', this.keyDown);\n    document.addEventListener('keyup', this.keyUp);\n\n    this.ctxViewSnapshot = this.$refs.viewSnapshotCanvas.getContext(\"2d\");\n    this.ctxCarSnapshot = this.$refs.carSnapshotCanvas.getContext(\"2d\");\n\n    this.ctxCar = this.$refs.carCanvas.getContext(\"2d\");\n    this.ctxView = this.$refs.viewCanvas.getContext(\"2d\");\n    this.ctxViewReduced = this.$refs.viewCanvasReduced.getContext(\"2d\");\n\n    this.refreshLoop();\n  },\n  methods: {\n    refreshLoop() {\n      window.requestAnimationFrame(() => {\n        const now = performance.now();\n        if( this.tick ) {\n          this.tickTime = now;\n          this.fps = this.fpsCounter;\n          this.fpsCounter = 0;\n          this.tick = false;\n        }\n        else {\n          this.fpsCounter++;\n          if( now >= this.tickTime + 1000 ) {\n            this.tick = true;\n          }\n        }\n\n        this.enterFrame();\n\n        this.refreshLoop();\n      });\n    },\n    enterFrame() {\n      if( this.worldLoaded && !this.training ) {\n        this.drawWorld();\n        this.calculate();\n        this.drawCar();\n      }\n    },\n    async train() {\n      this.training = true;\n\n      const featureValuesTraining =  [ [0.5,0.5,0.5] ];\n      const featureTensorTraining = tf.tensor2d( featureValuesTraining, [1, 3] );\n\n      const labelValuesTraining =  [ [0.5,0.5] ];\n      const labelTensorTraining = tf.tensor2d( labelValuesTraining, [labelValuesTraining.length, 2] );\n\n      console.log(\"creating model ...\");\n      this.model = tf.sequential();\n      this.model.add(tf.layers.dense({inputShape: 3, activation: \"sigmoid\", units: 5}));\n      this.model.add(tf.layers.dense({activation: \"relu\", units: 10}));\n      this.model.add(tf.layers.dense({activation: \"sigmoid\", units: 2}));\n      //this.model.compile({loss:'binaryCrossentropy',optimizer:tf.train.rmsprop(0.1),metrics:['accuracy']});\n      this.model.compile({loss:'categoricalCrossentropy',optimizer:tf.train.adam(),metrics:['accuracy']});\n\n      await this.trainModel( featureTensorTraining, labelTensorTraining );\n\n      const featureValuesTesting =  [ [0.5,0.5,0.5] ];\n      //console.log( await this.predict(featureValuesTesting) );\n\n      this.training = false;\n    },\n    async trainModel( featureTensorTraining, labelTensorTraining ) {\n      return this.model.fit( featureTensorTraining, labelTensorTraining, {\n        epochs: 10,\n        //validationSplit: 0.2,\n        callbacks: {\n          onEpochEnd: function(epoch) {\n            //predict( featureValuesTesting[0] );\n            console.log(\"epoch \"+epoch)\n          },\n          onTrainEnd: function() {\n            console.log(\"done\");\n          }\n        }\n      });\n    },\n    async predict( input ) {\n      return tf.tidy( () => {\n        const inputTensor = tf.tensor2d([input],[1, 3]);\n        const outputTensor = this.model.predict( inputTensor );\n        const outputValue = outputTensor.dataSync();\n\n        return outputValue;\n      });\n    },\n    calculate() {\n      if( this.car.steering ) {\n        if( this.car.steering === \"left\" ) {\n          this.car.angle -= this.car.steeringSpeed;\n        }\n        else {\n          this.car.angle += this.car.steeringSpeed;\n        }\n      }\n      this.car.x += Math.sin( this.car.angle ) *this.car.speed;\n      this.car.y -= Math.cos( this.car.angle ) *this.car.speed;\n    },\n    drawWorld() {\n      this.ctx.clearRect( 0, 0, this.ctx.canvas.width, this.ctx.canvas.height );\n      this.ctx.drawImage( this.imgWorld, 0, 0, this.ctx.canvas.width, this.ctx.canvas.height );\n    },\n    componentToHex(c) {\n      var hex = c.toString(16);\n      return hex.length == 1 ? \"0\" + hex : hex;\n    },\n    rgbToHex(r, g, b) {\n      return \"#\" + this.componentToHex(r) + this.componentToHex(g) + this.componentToHex(b);\n    },\n    reducePixels(pixels,size) {\n      // reduce resolution\n      let pixelsReduced = [];\n      for( let y = 0; y < size; y+=2 ) {\n        for( let x = 0; x < size; x+=2 ) {\n          const pixelIndexes = [\n            y*size + x,\n            y*size + x +1,\n            (y+1)*size + x,\n            (y+1)*size + x +1,\n          ];\n\n          let totalR = 0;\n          let totalG = 0;\n          let totalB = 0;\n          for( let i = 0; i < pixelIndexes.length; i++ ) {\n            totalR += pixels[pixelIndexes[i]][0];\n            totalG += pixels[pixelIndexes[i]][1];\n            totalB += pixels[pixelIndexes[i]][2];\n          }\n          totalR = Math.round( totalR / pixelIndexes.length );\n          totalG = Math.round( totalG / pixelIndexes.length );\n          totalB = Math.round( totalB / pixelIndexes.length );\n          pixelsReduced.push( [totalR,totalG,totalB] );\n        }\n      }\n      return pixelsReduced;\n    },\n    drawCar() {\n\n      // get car image\n      this.snapshotWhereCarIs = this.ctx.getImageData( this.car.x - this.ctxCarSnapshot.canvas.width/2, this.car.y - this.ctxCarSnapshot.canvas.height/2, this.ctxCarSnapshot.canvas.width, this.ctxCarSnapshot.canvas.height );\n\n      // read pixels\n      let carSnapshotPixels = [];\n      for( let i = 0; i < this.snapshotWhereCarIs.data.length; i += 4 ) {\n        const r = this.snapshotWhereCarIs.data[i];\n        const g = this.snapshotWhereCarIs.data[i+1];\n        const b = this.snapshotWhereCarIs.data[i+2];\n\n        carSnapshotPixels.push( [r,g,b] );\n      }\n\n      // draw rotated image\n      this.ctxCarSnapshot.save();\n      this.ctxCarSnapshot.clearRect( 0, 0, this.ctxCarSnapshot.canvas.width, this.ctxCarSnapshot.canvas.height );\n      this.ctxCarSnapshot.translate( this.ctxCarSnapshot.canvas.width/2, this.ctxCarSnapshot.canvas.height/2 );\n      this.ctxCarSnapshot.rotate( -this.car.angle );\n      this.ctxCarSnapshot.translate( -this.ctxCarSnapshot.canvas.width/2, -this.ctxCarSnapshot.canvas.height/2 );\n      for( let y = 0; y < this.ctxCarSnapshot.canvas.height; y++ ) {\n        for( let x = 0; x < this.ctxCarSnapshot.canvas.width; x++ ) {\n          const pixelIndex = y*this.ctxCarSnapshot.canvas.width + x;\n          const color = this.rgbToHex( carSnapshotPixels[pixelIndex][0], carSnapshotPixels[pixelIndex][1], carSnapshotPixels[pixelIndex][2] );\n          this.ctxCarSnapshot.fillStyle = color;\n          this.ctxCarSnapshot.fillRect( x, y, 1.5, 1.5 );\n        }\n      }\n      this.ctxCarSnapshot.restore();\n\n\n      // get car image\n      this.imgWhereCarIs = this.ctxCarSnapshot.getImageData( this.ctxCarSnapshot.canvas.width/2 - this.ctxCar.canvas.width/2, this.ctxCarSnapshot.canvas.height/2 - this.ctxCar.canvas.height/2, this.ctxCar.canvas.width, this.ctxCar.canvas.height );\n      this.ctxCar.putImageData(this.imgWhereCarIs, 0, 0);\n\n\n      // read pixels\n      let totalR = 0;\n      let totalG = 0;\n      let totalB = 0;\n      for( let i = 0; i < this.imgWhereCarIs.data.length; i += 4 ) {\n        totalR += this.imgWhereCarIs.data[i];\n        totalG += this.imgWhereCarIs.data[i+1];\n        totalB += this.imgWhereCarIs.data[i+2];\n      }\n      totalR = Math.round( totalR / (this.imgWhereCarIs.data.length /4) );\n      totalG = Math.round( totalG / (this.imgWhereCarIs.data.length /4) );\n      totalB = Math.round( totalB / (this.imgWhereCarIs.data.length /4) );\n      if( totalR + totalG + totalB < 760 ) {\n        console.log(\"collision\");\n\n        this.inputValues = [];\n        this.restart();\n\n\n        this.train();\n\n      }\n\n\n\n\n      // view\n\n      const viewX = this.car.x + Math.sin( this.car.angle ) * (this.car.length/2+this.viewSize/2);\n      const viewY = this.car.y - Math.cos( this.car.angle ) * (this.car.length/2+this.viewSize/2);\n\n\n      // get view image\n      this.snapshotWhereViewIs = this.ctx.getImageData( viewX - this.ctxViewSnapshot.canvas.width/2, viewY - this.ctxViewSnapshot.canvas.height/2, this.ctxViewSnapshot.canvas.width, this.ctxViewSnapshot.canvas.height );\n\n      // read pixels\n      let viewSnapshotPixels = [];\n      for( let i = 0; i < this.snapshotWhereViewIs.data.length; i += 4 ) {\n        const r = this.snapshotWhereViewIs.data[i];\n        const g = this.snapshotWhereViewIs.data[i+1];\n        const b = this.snapshotWhereViewIs.data[i+2];\n\n        viewSnapshotPixels.push( [r,g,b] );\n      }\n\n\n      // draw rotated image\n      this.ctxViewSnapshot.save();\n      this.ctxViewSnapshot.clearRect( 0, 0, this.ctxViewSnapshot.canvas.width, this.ctxViewSnapshot.canvas.height );\n      this.ctxViewSnapshot.translate( this.ctxViewSnapshot.canvas.width/2, this.ctxViewSnapshot.canvas.height/2 );\n      this.ctxViewSnapshot.rotate( -this.car.angle );\n      this.ctxViewSnapshot.translate( -this.ctxViewSnapshot.canvas.width/2, -this.ctxViewSnapshot.canvas.height/2 );\n      for( let y = 0; y < this.ctxViewSnapshot.canvas.height; y++ ) {\n        for( let x = 0; x < this.ctxViewSnapshot.canvas.width; x++ ) {\n          const pixelIndex = y*this.ctxViewSnapshot.canvas.width + x;\n          const color = this.rgbToHex( viewSnapshotPixels[pixelIndex][0], viewSnapshotPixels[pixelIndex][1], viewSnapshotPixels[pixelIndex][2] );\n          this.ctxViewSnapshot.fillStyle = color;\n          this.ctxViewSnapshot.fillRect( x, y, 1.5, 1.5 );\n        }\n      }\n      this.ctxViewSnapshot.restore();\n\n      // get view image\n      this.imgWhereViewIs = this.ctxViewSnapshot.getImageData( this.ctxViewSnapshot.canvas.width/2 - this.ctxView.canvas.width/2, this.ctxViewSnapshot.canvas.height/2 - this.ctxView.canvas.height/2, this.ctxView.canvas.width, this.ctxView.canvas.height );\n      this.ctxView.putImageData(this.imgWhereViewIs, 0, 0);\n\n      // read pixels\n      let viewPixels = [];\n      for( let i = 0; i < this.imgWhereViewIs.data.length; i += 4 ) {\n        const r = this.imgWhereViewIs.data[i];\n        const g = this.imgWhereViewIs.data[i+1];\n        const b = this.imgWhereViewIs.data[i+2];\n        viewPixels.push( [r,g,b] );\n      }\n\n\n      let viewPixelsReduced = viewPixels;\n      for( let i = 0; i < this.viewReduction; i++ ) {\n        viewPixelsReduced = this.reducePixels( viewPixelsReduced, Math.sqrt(viewPixelsReduced.length) );\n      }\n\n      this.inputValues.unshift(viewPixelsReduced);\n      this.inputValues = this.inputValues.slice(0,16);\n\n      // draw reduced view\n      for( let y = 0; y < this.ctxViewReduced.canvas.height; y++ ) {\n        for( let x = 0; x < this.ctxViewReduced.canvas.width; x++ ) {\n          const pixelIndex = y*this.ctxViewReduced.canvas.width + x;\n          const color = this.rgbToHex( viewPixelsReduced[pixelIndex][0], viewPixelsReduced[pixelIndex][1], viewPixelsReduced[pixelIndex][2] );\n          this.ctxViewReduced.fillStyle = color;\n          this.ctxViewReduced.fillRect( x, y, 1.5, 1.5 );\n        }\n      }\n\n\n      // draw car\n      this.ctx.save();\n      this.ctx.translate( this.car.x, this.car.y );\n      this.ctx.rotate( this.car.angle );\n      this.ctx.translate( -this.car.x, -this.car.y );\n      this.ctx.fillRect( this.car.x -this.car.width/2, this.car.y -this.car.length/2, this.car.width, this.car.length );\n      this.ctx.restore();\n\n\n      /*\n\n      // draw view snapshot rect\n      this.ctx.save();\n      this.ctx.strokeStyle = \"#ff0000\";\n      this.ctx.beginPath();\n      this.ctx.rect( viewX -this.ctxViewSnapshot.canvas.width/2, viewY -this.ctxViewSnapshot.canvas.height/2, this.ctxViewSnapshot.canvas.width, this.ctxViewSnapshot.canvas.height );\n      this.ctx.stroke();\n      this.ctx.restore();\n      */\n\n\n      // draw view rect\n      this.ctx.save();\n      this.ctx.translate( viewX, viewY );\n      this.ctx.rotate( this.car.angle );\n      this.ctx.translate( -viewX, -viewY );\n      this.ctx.strokeStyle = \"#ff0000\";\n      this.ctx.beginPath();\n      this.ctx.rect( viewX -this.ctxView.canvas.width/2, viewY -this.ctxView.canvas.height/2, this.ctxView.canvas.width, this.ctxView.canvas.height );\n      this.ctx.stroke();\n      this.ctx.restore();\n\n    },\n    restart() {\n      console.log( \"restart \");\n      this.car.x = this.worldWidth / 2 * 0.333;\n      this.car.y = this.worldHeight / 2;\n      this.car.angle = 0;\n    },\n    keyDown(e) {\n      if( e.code === \"ArrowLeft\" ) {\n        this.car.steering = \"left\";\n      }\n      else if( e.code === \"ArrowRight\" ) {\n        this.car.steering = \"right\";\n      }\n    },\n    keyUp(e) {\n      if( e.code === \"ArrowLeft\" ) {\n        this.car.steering = undefined;\n      }\n      else if( e.code === \"ArrowRight\" ) {\n        this.car.steering = undefined;\n      }\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\">\n\nbody {\n  margin: 0;\n  height: 100vh;\n  font-family: sans-serif;\n}\n#app {\n  height: 100%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  background-color: black;\n}\n\n.world {\n  position: relative;\n  width: 50%;\n  height: 0;\n  padding-top: 50%;\n  canvas {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n  }\n}\n\n\n.car-snapshot-canvas {\n  position: absolute;\n  top: 8px;\n  left: 8px;\n  border: 1px solid white;\n  image-rendering: pixelated;\n  width: 10%;\n  display: none;\n}\n.car-canvas {\n  position: absolute;\n  bottom: 8px;\n  left: 8px;\n  border: 1px solid white;\n  image-rendering: pixelated;\n  width: 15%;\n  display: none;\n}\n.view-snapshot-canvas {\n  position: absolute;\n  top: 8px;\n  right: 8px;\n  border: 1px solid white;\n  image-rendering: pixelated;\n  width: 10%;\n  display: none;\n}\n.view-canvas {\n  position: absolute;\n  bottom: 8px;\n  right: 8px;\n  border: 1px solid white;\n  image-rendering: pixelated;\n  width: 10%;\n  display: none;\n}\n.view-canvas-reduced {\n  position: absolute;\n  bottom: 8px;\n  right: 8px;\n  border: 1px solid white;\n  image-rendering: pixelated;\n  width: 15%;\n}\n\n\n\n.fps {\n  position: absolute;\n  top: 8px;\n  left: 50%;\n  color: #333333;\n}\n\n</style>\n"]}]}