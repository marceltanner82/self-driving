{"map":"{\"version\":3,\"sources\":[\"js/app.92b2604c.js\"],\"names\":[\"modules\",\"webpackJsonpCallback\",\"data\",\"moduleId\",\"chunkId\",\"chunkIds\",\"moreModules\",\"executeModules\",\"i\",\"resolves\",\"length\",\"Object\",\"prototype\",\"hasOwnProperty\",\"call\",\"installedChunks\",\"push\",\"parentJsonpFunction\",\"shift\",\"deferredModules\",\"apply\",\"checkDeferredModules\",\"result\",\"deferredModule\",\"fulfilled\",\"j\",\"depId\",\"splice\",\"__webpack_require__\",\"s\",\"installedModules\",\"app\",\"exports\",\"module\",\"l\",\"m\",\"c\",\"d\",\"name\",\"getter\",\"o\",\"defineProperty\",\"enumerable\",\"get\",\"r\",\"Symbol\",\"toStringTag\",\"value\",\"t\",\"mode\",\"__esModule\",\"ns\",\"create\",\"key\",\"bind\",\"n\",\"object\",\"property\",\"p\",\"jsonpArray\",\"window\",\"oldJsonpFunction\",\"slice\",\"0\",\"1\",\"2\",\"3\",\"3251\",\"4\",\"5\",\"56d7\",\"__webpack_exports__\",\"vue_runtime_esm\",\"Appvue_type_template_id_01c425a9_render\",\"_vm\",\"this\",\"_h\",\"$createElement\",\"_c\",\"_self\",\"attrs\",\"id\",\"staticClass\",\"ref\",\"width\",\"worldWidth\",\"height\",\"worldHeight\",\"_v\",\"_s\",\"trainingProgress\",\"_e\",\"car\",\"viewSize\",\"reducedViewSize\",\"fps\",\"durationString\",\"highscoreMaxLength\",\"_l\",\"highscore\",\"index\",\"score\",\"lastScore\",\"staticRenderFns\",\"toConsumableArray\",\"asyncToGenerator\",\"tf\",\"Appvue_type_script_lang_js_\",\"ctx\",\"imgWorld\",\"worldLoaded\",\"fpsCounter\",\"tick\",\"tickTime\",\"duration\",\"x\",\"y\",\"speed\",\"steeringSpeed\",\"angle\",\"viewReduction\",\"viewReducedSize\",\"viewPixels\",\"steering\",\"samples\",\"samplesMaxLength\",\"highscores\",\"referenceScoreMax\",\"training\",\"model\",\"computed\",\"reducedSize\",\"mounted\",\"$refs\",\"canvas\",\"getContext\",\"Image\",\"src\",\"onload\",\"document\",\"addEventListener\",\"keyDown\",\"keyUp\",\"ctxViewSnapshot\",\"viewSnapshotCanvas\",\"ctxCarSnapshot\",\"carSnapshotCanvas\",\"ctxCar\",\"carCanvas\",\"ctxView\",\"viewCanvas\",\"ctxViewReduced\",\"viewCanvasReduced\",\"ctxStats\",\"statsCanvas\",\"console\",\"log\",\"sequential\",\"add\",\"layers\",\"dense\",\"inputShape\",\"activation\",\"units\",\"compile\",\"loss\",\"optimizer\",\"train\",\"rmsprop\",\"metrics\",\"refreshLoop\",\"methods\",\"_this\",\"regeneratorRuntime\",\"mark\",\"_callee\",\"highscoreSamples\",\"featureValuesTraining\",\"labelValuesTraining\",\"_i\",\"featureValueTraining\",\"featureTensorTraining\",\"labelTensorTraining\",\"wrap\",\"_context\",\"prev\",\"next\",\"sort\",\"Math\",\"random\",\"state\",\"reward\",\"action\",\"tensor2d\",\"trainModel\",\"stop\",\"epochs\",\"_this2\",\"_callee2\",\"_context2\",\"abrupt\",\"fit\",\"callbacks\",\"onEpochEnd\",\"epoch\",\"round\",\"onTrainEnd\",\"predict\",\"input\",\"_this3\",\"_callee3\",\"_context3\",\"tidy\",\"inputTensor\",\"outputTensor\",\"outputValue\",\"dataSync\",\"getSteering\",\"_this4\",\"_callee4\",\"_context4\",\"testingDataInput\",\"prediction\",\"sent\",\"max\",\"_this5\",\"requestAnimationFrame\",\"now\",\"performance\",\"date\",\"Date\",\"setSeconds\",\"toISOString\",\"substr\",\"enterFrame\",\"drawWorld\",\"getView\",\"moveCar\",\"drawStats\",\"clearRect\",\"beginPath\",\"fillStyle\",\"arc\",\"actionPredicted\",\"PI\",\"fill\",\"rgb\",\"toString\",\"then\",\"randomisation\",\"min\",\"steeringPredicted\",\"randomisedValue\",\"steeringStrength\",\"_steeringStrength\",\"sin\",\"cos\",\"checkCarCollision\",\"viewX\",\"viewY\",\"snapshotWhereViewIs\",\"getImageData\",\"viewSnapshotPixels\",\"g\",\"b\",\"save\",\"translate\",\"rotate\",\"pixelIndex\",\"color\",\"rgbToHex\",\"fillRect\",\"restore\",\"imgWhereViewIs\",\"putImageData\",\"_i2\",\"_r\",\"_g\",\"_b\",\"previousTotalBrightness\",\"viewPixelsReduced\",\"_i3\",\"reducePixels\",\"sqrt\",\"_y\",\"_x\",\"_pixelIndex\",\"_color\",\"unshift\",\"totalBrightness\",\"_i4\",\"brightness\",\"brightnessChange\",\"brightnessChangePushed\",\"darkness\",\"abs\",\"snapshotWhereCarIs\",\"carSnapshotPixels\",\"imgWhereCarIs\",\"drawCarAndViewSquare\",\"totalR\",\"totalG\",\"totalB\",\"_i5\",\"undefined\",\"resetCar\",\"a\",\"strokeStyle\",\"rect\",\"stroke\",\"componentToHex\",\"hex\",\"pixels\",\"size\",\"pixelsReduced\",\"pixelIndexes\",\"drawImage\",\"src_Appvue_type_script_lang_js_\",\"componentNormalizer\",\"component\",\"App\",\"config\",\"productionTip\",\"render\",\"h\",\"$mount\",\"5c0b\",\"6\",\"7\",\"8\",\"9c0c\"],\"mappings\":\"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\"}","code":"(function(t){function e(e){for(var i,n,h=e[0],c=e[1],o=e[2],d=0,g=[];d<h.length;d++)n=h[d],Object.prototype.hasOwnProperty.call(a,n)&&a[n]&&g.push(a[n][0]),a[n]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(t[i]=c[i]);l&&l(e);while(g.length)g.shift()();return r.push.apply(r,o||[]),s()}function s(){for(var t,e=0;e<r.length;e++){for(var s=r[e],i=!0,h=1;h<s.length;h++){var c=s[h];0!==a[c]&&(i=!1)}i&&(r.splice(e--,1),t=n(n.s=s[0]))}return t}var i={},a={app:0},r=[];function n(e){if(i[e])return i[e].exports;var s=i[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=t,n.c=i,n.d=function(t,e,s){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},n.r=function(t){\"undefined\"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(t,\"__esModule\",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&\"object\"===typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,\"default\",{enumerable:!0,value:t}),2&e&&\"string\"!=typeof t)for(var i in t)n.d(s,i,function(e){return t[e]}.bind(null,i));return s},n.n=function(t){var e=t&&t.__esModule?function(){return t[\"default\"]}:function(){return t};return n.d(e,\"a\",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p=\"/selfdriving/\";var h=window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[],c=h.push.bind(h);h.push=e,h=h.slice();for(var o=0;o<h.length;o++)e(h[o]);var l=c;r.push([0,\"chunk-vendors\"]),s()})({0:function(t,e,s){t.exports=s(\"56d7\")},1:function(t,e){},2:function(t,e){},3:function(t,e){},3251:function(t,e,s){t.exports=s.p+\"img/world3.1400e9f6.jpg\"},4:function(t,e){},5:function(t,e){},\"56d7\":function(t,e,s){\"use strict\";s.r(e);s(\"e260\"),s(\"e6cf\"),s(\"cca6\"),s(\"a79d\");var i=s(\"2b0e\"),a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s(\"div\",{attrs:{id:\"app\"}},[s(\"div\",{staticClass:\"world\"},[s(\"canvas\",{ref:\"canvas\",staticClass:\"world-canvas\",attrs:{width:t.worldWidth,height:t.worldHeight}}),t.training?s(\"div\",{staticClass:\"training\"},[s(\"span\",[t._v(\"training\"),s(\"br\"),t._v(t._s(t.trainingProgress)+\"%\")])]):t._e()]),s(\"canvas\",{ref:\"carSnapshotCanvas\",staticClass:\"car-snapshot-canvas\",attrs:{width:1.5*t.car.length,height:1.5*t.car.length}}),s(\"canvas\",{ref:\"viewSnapshotCanvas\",staticClass:\"view-snapshot-canvas\",attrs:{width:1.5*t.viewSize,height:1.5*t.viewSize}}),s(\"canvas\",{ref:\"carCanvas\",staticClass:\"car-canvas\",attrs:{width:t.car.width,height:t.car.length}}),s(\"canvas\",{ref:\"viewCanvas\",staticClass:\"view-canvas\",attrs:{width:t.viewSize,height:t.viewSize}}),s(\"canvas\",{ref:\"viewCanvasReduced\",staticClass:\"view-canvas-reduced\",attrs:{width:t.reducedViewSize,height:t.reducedViewSize}}),s(\"span\",{staticClass:\"fps\"},[t._v(t._s(t.fps)+\" fps\")]),s(\"div\",{staticClass:\"highscores\"},[s(\"div\",{staticClass:\"duration\"},[s(\"label\",[t._v(\"Total Duration\")]),t._v(\" \"+t._s(t.durationString)+\" \")]),s(\"label\",[t._v(\"Highscores (\"+t._s(t.highscoreMaxLength)+\")\")]),s(\"ul\",t._l(t.highscores,(function(e,i){return s(\"li\",{key:i},[t._v(t._s(e.score))])})),0)]),s(\"div\",{staticClass:\"score\"},[s(\"div\",{staticClass:\"current\"},[s(\"label\",[t._v(\"Current Score\")]),t._v(\" \"+t._s(t.score)+\" \")]),s(\"div\",{staticClass:\"last\"},[s(\"label\",[t._v(\"Last Score\")]),t._v(\" \"+t._s(t.lastScore)+\" \")])]),s(\"canvas\",{ref:\"statsCanvas\",staticClass:\"stats-canvas\",attrs:{width:40,height:500}})])},r=[],n=s(\"2909\"),h=s(\"1da1\"),c=(s(\"96cf\"),s(\"4e82\"),s(\"cb29\"),s(\"d3b7\"),s(\"25f0\"),s(\"fb6a\"),s(\"ce1a\")),o={name:\"App\",data:function(){return{ctx:null,worldWidth:256,worldHeight:256,imgWorld:null,worldLoaded:!1,fps:null,fpsCounter:null,tick:!0,tickTime:null,duration:-1,durationString:null,car:{width:8,length:16,x:42.624,y:192,speed:.5,steeringSpeed:.025,angle:0},viewSize:32,viewReduction:3,viewReducedSize:null,viewPixels:null,steering:null,samples:[],samplesMaxLength:256,score:0,lastScore:null,highscores:[],highscoreMaxLength:15,referenceScoreMax:2500,training:!1,trainingProgress:0,model:null}},computed:{reducedViewSize:function(){for(var t=this.viewSize,e=0;e<this.viewReduction;e++)t/=2;return t}},mounted:function(){this.ctx=this.$refs.canvas.getContext(\"2d\"),this.imgWorld=new Image(this.worldWidth,this.worldHeight),this.imgWorld.src=s(\"3251\");var t=this;this.imgWorld.onload=function(){t.worldLoaded=!0},document.addEventListener(\"keydown\",this.keyDown),document.addEventListener(\"keyup\",this.keyUp),this.ctxViewSnapshot=this.$refs.viewSnapshotCanvas.getContext(\"2d\"),this.ctxCarSnapshot=this.$refs.carSnapshotCanvas.getContext(\"2d\"),this.ctxCar=this.$refs.carCanvas.getContext(\"2d\"),this.ctxView=this.$refs.viewCanvas.getContext(\"2d\"),this.ctxViewReduced=this.$refs.viewCanvasReduced.getContext(\"2d\"),this.ctxStats=this.$refs.statsCanvas.getContext(\"2d\"),console.log(\"creating model ...\"),this.viewReducedSize=this.viewSize;for(var e=0;e<this.viewReduction;e++)this.viewReducedSize=this.viewReducedSize/2;this.model=c.sequential(),this.model.add(c.layers.dense({inputShape:this.viewReducedSize*this.viewReducedSize+1,activation:\"sigmoid\",units:5})),this.model.add(c.layers.dense({activation:\"relu\",units:10})),this.model.add(c.layers.dense({activation:\"sigmoid\",units:1})),this.model.compile({loss:\"binaryCrossentropy\",optimizer:c.train.rmsprop(.1),metrics:[\"accuracy\"]}),this.refreshLoop()},methods:{train:function(){var t=this;return Object(h[\"a\"])(regeneratorRuntime.mark((function e(){var s,i,a,r,h,o,l,d;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:for(t.training=!0,s=[],i=0;i<t.highscores.length;i++)s.push.apply(s,Object(n[\"a\"])(t.highscores[i].samples));for(s.push.apply(s,Object(n[\"a\"])(t.samples)),s.sort((function(){return.5-Math.random()})),console.log(\"total number of samples: \"+s.length),a=[],r=[],h=0;h<s.length;h++)o=Object(n[\"a\"])(s[h].state),o.push(s[h].reward),a.push(o),r.push(s[h].action);return l=c.tensor2d(a,[a.length,a[0].length]),d=c.tensor2d(r,[r.length,1]),console.log(\"train model ...\"),e.next=14,t.trainModel(l,d,10);case 14:t.training=!1,t.trainingProgress=0;case 16:case\"end\":return e.stop()}}),e)})))()},trainModel:function(t,e,s){var i=this;return Object(h[\"a\"])(regeneratorRuntime.mark((function a(){var r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r=i,a.abrupt(\"return\",i.model.fit(t,e,{epochs:s,callbacks:{onEpochEnd:function(t){r.trainingProgress=Math.round(t/s*100)},onTrainEnd:function(){console.log(\"done\")}}}));case 2:case\"end\":return a.stop()}}),a)})))()},predict:function(t){var e=this;return Object(h[\"a\"])(regeneratorRuntime.mark((function s(){return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.abrupt(\"return\",c.tidy((function(){var s=c.tensor2d([t],[1,e.viewReducedSize*e.viewReducedSize+1]),i=e.model.predict(s),a=i.dataSync();return a})));case 1:case\"end\":return s.stop()}}),s)})))()},getSteering:function(){var t=this;return Object(h[\"a\"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.predict(t.testingDataInput);case 2:return t.prediction=e.sent,t.prediction=Math.max(0,t.prediction),e.abrupt(\"return\",t.prediction);case 5:case\"end\":return e.stop()}}),e)})))()},refreshLoop:function(){var t=this;window.requestAnimationFrame((function(){var e=performance.now();if(t.tick){t.tickTime=e,t.fps=t.fpsCounter,t.fpsCounter=0,t.tick=!1,t.duration++;var s=new Date(0);s.setSeconds(t.duration),t.durationString=s.toISOString().substr(11,8)}else t.fpsCounter++,e>=t.tickTime+1e3&&(t.tick=!0);t.enterFrame(),t.refreshLoop()}))},enterFrame:function(){this.worldLoaded&&!this.training&&(this.drawWorld(),this.getView(),this.moveCar())},drawStats:function(){this.ctxStats.clearRect(0,0,this.ctxStats.canvas.width,this.ctxStats.canvas.height);for(var t=0;t<this.samples.length;t++){this.ctxStats.beginPath(),this.ctxStats.fillStyle=\"#ffffff\",this.ctxStats.arc(this.samples[t].actionPredicted*this.ctxStats.canvas.width,this.ctxStats.canvas.height/this.samples.length*t,1,0,2*Math.PI),this.ctxStats.fill(),this.ctxStats.beginPath();var e=void 0;e=1===this.samples[t].reward?\"#00ff00\":\"#\"+Math.round(255*(1-this.samples[t].reward)).toString(16)+\"0000\",this.ctxStats.fillStyle=e,this.ctxStats.arc(this.samples[t].action*this.ctxStats.canvas.width,this.ctxStats.canvas.height/this.samples.length*t,1,0,2*Math.PI),this.ctxStats.fill()}},moveCar:function(){this.testingDataInput=Object(n[\"a\"])(this.viewPixels),this.testingDataInput.push(1);var t=this;this.getSteering().then((function(e){var s;e=Math.min(e,1),e=Math.max(e,0),console.log(\"predicted steering: \"+e),t.car.steeringPredicted=e,s=t.samples[0]?t.samples[0].reward<.5?1:0:1,console.log(\"randomisation: \"+s);var i=Math.random(),a=e-1*s+i*s*2;if(a=Math.min(a,1),a=Math.max(a,0),t.car.steering=a,console.log(\"new steering: \"+a),t.car.steering<.5){var r=2*(.5-t.car.steering);t.car.angle-=t.car.steeringSpeed*r}else if(t.car.steering>.5){var n=2*(t.car.steering-.5);t.car.angle+=t.car.steeringSpeed*n}t.car.x+=Math.sin(t.car.angle)*t.car.speed,t.car.y-=Math.cos(t.car.angle)*t.car.speed,t.checkCarCollision()}))},getView:function(){this.car.viewX=this.car.x+Math.sin(this.car.angle)*(this.car.length/2+this.viewSize/2),this.car.viewY=this.car.y-Math.cos(this.car.angle)*(this.car.length/2+this.viewSize/2),this.snapshotWhereViewIs=this.ctx.getImageData(this.car.viewX-this.ctxViewSnapshot.canvas.width/2,this.car.viewY-this.ctxViewSnapshot.canvas.height/2,this.ctxViewSnapshot.canvas.width,this.ctxViewSnapshot.canvas.height);for(var t=[],e=0;e<this.snapshotWhereViewIs.data.length;e+=4){var s=this.snapshotWhereViewIs.data[e],i=this.snapshotWhereViewIs.data[e+1],a=this.snapshotWhereViewIs.data[e+2];t.push([s,i,a])}this.ctxViewSnapshot.save(),this.ctxViewSnapshot.clearRect(0,0,this.ctxViewSnapshot.canvas.width,this.ctxViewSnapshot.canvas.height),this.ctxViewSnapshot.translate(this.ctxViewSnapshot.canvas.width/2,this.ctxViewSnapshot.canvas.height/2),this.ctxViewSnapshot.rotate(-this.car.angle),this.ctxViewSnapshot.translate(-this.ctxViewSnapshot.canvas.width/2,-this.ctxViewSnapshot.canvas.height/2);for(var r=0;r<this.ctxViewSnapshot.canvas.height;r++)for(var n=0;n<this.ctxViewSnapshot.canvas.width;n++){var h=r*this.ctxViewSnapshot.canvas.width+n,c=this.rgbToHex(t[h][0],t[h][1],t[h][2]);this.ctxViewSnapshot.fillStyle=c,this.ctxViewSnapshot.fillRect(n,r,1.5,1.5)}this.ctxViewSnapshot.restore(),this.imgWhereViewIs=this.ctxViewSnapshot.getImageData(this.ctxViewSnapshot.canvas.width/2-this.ctxView.canvas.width/2,this.ctxViewSnapshot.canvas.height/2-this.ctxView.canvas.height/2,this.ctxView.canvas.width,this.ctxView.canvas.height),this.ctxView.putImageData(this.imgWhereViewIs,0,0);for(var o=[],l=0;l<this.imgWhereViewIs.data.length;l+=4){var d=this.imgWhereViewIs.data[l],g=this.imgWhereViewIs.data[l+1],u=this.imgWhereViewIs.data[l+2];o.push([d,g,u])}for(var v,p=o,w=0;w<this.viewReduction;w++)p=this.reducePixels(p,Math.sqrt(p.length));for(var x=0;x<this.ctxViewReduced.canvas.height;x++)for(var f=0;f<this.ctxViewReduced.canvas.width;f++){var S=x*this.ctxViewReduced.canvas.width+f,m=this.rgbToHex(p[S][0],p[S][1],p[S][2]);this.ctxViewReduced.fillStyle=m,this.ctxViewReduced.fillRect(f,x,1.5,1.5)}this.viewPixels&&(this.samples.unshift({state:this.viewPixels,action:this.car.steering,actionPredicted:this.car.steeringPredicted}),this.samples=this.samples.slice(0,this.samplesMaxLength),v=this.totalBrightness),this.viewPixels=[],this.totalBrightness=0;for(var C=0;C<p.length;C++){var V=(p[C][0]+p[C][1]+p[C][2])/765;this.viewPixels.push(V),this.totalBrightness+=V}if(this.totalBrightness=this.totalBrightness/this.viewPixels.length,this.samples.length){var b,y=this.totalBrightness-v;if(y>=0)b=1;else{var I=10*y,M=1-this.totalBrightness;b=.5-Math.min(.5,Math.abs(I)*M)}this.samples[0].reward=b}},checkCarCollision:function(){this.snapshotWhereCarIs=this.ctx.getImageData(this.car.x-this.ctxCarSnapshot.canvas.width/2,this.car.y-this.ctxCarSnapshot.canvas.height/2,this.ctxCarSnapshot.canvas.width,this.ctxCarSnapshot.canvas.height);for(var t=[],e=0;e<this.snapshotWhereCarIs.data.length;e+=4){var s=this.snapshotWhereCarIs.data[e],i=this.snapshotWhereCarIs.data[e+1],a=this.snapshotWhereCarIs.data[e+2];t.push([s,i,a])}this.ctxCarSnapshot.save(),this.ctxCarSnapshot.clearRect(0,0,this.ctxCarSnapshot.canvas.width,this.ctxCarSnapshot.canvas.height),this.ctxCarSnapshot.translate(this.ctxCarSnapshot.canvas.width/2,this.ctxCarSnapshot.canvas.height/2),this.ctxCarSnapshot.rotate(-this.car.angle),this.ctxCarSnapshot.translate(-this.ctxCarSnapshot.canvas.width/2,-this.ctxCarSnapshot.canvas.height/2);for(var r=0;r<this.ctxCarSnapshot.canvas.height;r++)for(var h=0;h<this.ctxCarSnapshot.canvas.width;h++){var c=r*this.ctxCarSnapshot.canvas.width+h,o=this.rgbToHex(t[c][0],t[c][1],t[c][2]);this.ctxCarSnapshot.fillStyle=o,this.ctxCarSnapshot.fillRect(h,r,1.5,1.5)}this.ctxCarSnapshot.restore(),this.imgWhereCarIs=this.ctxCarSnapshot.getImageData(this.ctxCarSnapshot.canvas.width/2-this.ctxCar.canvas.width/2,this.ctxCarSnapshot.canvas.height/2-this.ctxCar.canvas.height/2,this.ctxCar.canvas.width,this.ctxCar.canvas.height),this.ctxCar.putImageData(this.imgWhereCarIs,0,0),this.drawCarAndViewSquare();for(var l=0,d=0,g=0,u=0;u<this.imgWhereCarIs.data.length;u+=4)l+=this.imgWhereCarIs.data[u],d+=this.imgWhereCarIs.data[u+1],g+=this.imgWhereCarIs.data[u+2];l=Math.round(l/(this.imgWhereCarIs.data.length/4)),d=Math.round(d/(this.imgWhereCarIs.data.length/4)),g=Math.round(g/(this.imgWhereCarIs.data.length/4)),l+d+g<760?(console.log(\"collision!\"),this.viewPixels=null,this.car.steering=void 0,this.resetCar(),this.samples[0].reward=0,(this.highscores.length<this.highscoreMaxLength||this.score>this.highscores[this.highscoreMaxLength-1].score)&&(console.log(\"new highscore\"),this.highscores.push({score:this.score,samples:Object(n[\"a\"])(this.samples)}),this.highscores.sort((function(t,e){return e.score-t.score})),this.highscores=this.highscores.slice(0,this.highscoreMaxLength)),console.log(\"train\"),this.train(),this.drawStats(),this.samples=[],this.lastScore=this.score,this.score=0):(this.score++,this.drawStats())},drawCarAndViewSquare:function(){this.ctx.save(),this.ctx.translate(this.car.x,this.car.y),this.ctx.rotate(this.car.angle),this.ctx.translate(-this.car.x,-this.car.y),this.ctx.fillRect(this.car.x-this.car.width/2,this.car.y-this.car.length/2,this.car.width,this.car.length),this.ctx.restore(),this.ctx.save(),this.ctx.translate(this.car.viewX,this.car.viewY),this.ctx.rotate(this.car.angle),this.ctx.translate(-this.car.viewX,-this.car.viewY),this.ctx.strokeStyle=\"#ff0000\",this.ctx.beginPath(),this.ctx.rect(this.car.viewX-this.ctxView.canvas.width/2,this.car.viewY-this.ctxView.canvas.height/2,this.ctxView.canvas.width,this.ctxView.canvas.height),this.ctx.stroke(),this.ctx.restore()},componentToHex:function(t){var e=t.toString(16);return 1==e.length?\"0\"+e:e},rgbToHex:function(t,e,s){return\"#\"+this.componentToHex(t)+this.componentToHex(e)+this.componentToHex(s)},reducePixels:function(t,e){for(var s=[],i=0;i<e;i+=2)for(var a=0;a<e;a+=2){for(var r=[i*e+a,i*e+a+1,(i+1)*e+a,(i+1)*e+a+1],n=0,h=0,c=0,o=0;o<r.length;o++)n+=t[r[o]][0],h+=t[r[o]][1],c+=t[r[o]][2];n=Math.round(n/r.length),h=Math.round(h/r.length),c=Math.round(c/r.length),s.push([n,h,c])}return s},drawWorld:function(){this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.drawImage(this.imgWorld,0,0,this.ctx.canvas.width,this.ctx.canvas.height)},resetCar:function(){console.log(\"reset car\"),this.car.x=this.worldWidth/2*.333,this.car.y=this.worldHeight/2*1.5,this.car.angle=0}}},l=o,d=(s(\"5c0b\"),s(\"2877\")),g=Object(d[\"a\"])(l,a,r,!1,null,null,null),u=g.exports;i[\"a\"].config.productionTip=!1,new i[\"a\"]({render:function(t){return t(u)}}).$mount(\"#app\")},\"5c0b\":function(t,e,s){\"use strict\";s(\"9c0c\")},6:function(t,e){},7:function(t,e){},8:function(t,e){},\"9c0c\":function(t,e,s){}});","extractedComments":[]}