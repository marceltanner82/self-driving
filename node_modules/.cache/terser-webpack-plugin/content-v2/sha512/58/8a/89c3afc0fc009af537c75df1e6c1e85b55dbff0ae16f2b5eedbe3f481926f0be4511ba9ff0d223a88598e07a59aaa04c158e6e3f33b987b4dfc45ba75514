{"map":"{\"version\":3,\"sources\":[\"js/app.9e46249e.js\"],\"names\":[\"modules\",\"webpackJsonpCallback\",\"data\",\"moduleId\",\"chunkId\",\"chunkIds\",\"moreModules\",\"executeModules\",\"i\",\"resolves\",\"length\",\"Object\",\"prototype\",\"hasOwnProperty\",\"call\",\"installedChunks\",\"push\",\"parentJsonpFunction\",\"shift\",\"deferredModules\",\"apply\",\"checkDeferredModules\",\"result\",\"deferredModule\",\"fulfilled\",\"j\",\"depId\",\"splice\",\"__webpack_require__\",\"s\",\"installedModules\",\"app\",\"exports\",\"module\",\"l\",\"m\",\"c\",\"d\",\"name\",\"getter\",\"o\",\"defineProperty\",\"enumerable\",\"get\",\"r\",\"Symbol\",\"toStringTag\",\"value\",\"t\",\"mode\",\"__esModule\",\"ns\",\"create\",\"key\",\"bind\",\"n\",\"object\",\"property\",\"p\",\"jsonpArray\",\"window\",\"oldJsonpFunction\",\"slice\",\"0\",\"1\",\"2\",\"3\",\"4\",\"5\",\"56d7\",\"__webpack_exports__\",\"vue_runtime_esm\",\"Appvue_type_template_id_37aa0aa6_render\",\"_vm\",\"this\",\"_h\",\"$createElement\",\"_c\",\"_self\",\"attrs\",\"id\",\"staticClass\",\"ref\",\"width\",\"worldWidth\",\"height\",\"worldHeight\",\"_v\",\"_s\",\"trainingProgress\",\"trainingSamples\",\"_e\",\"car\",\"viewSize\",\"reducedViewSize\",\"fps\",\"durationString\",\"highscores\",\"_l\",\"highscore\",\"index\",\"models\",\"modelIndex\",\"score\",\"lastScore\",\"model\",\"class\",\"active\",\"layer\",\"units\",\"activation\",\"trainings\",\"staticRenderFns\",\"toConsumableArray\",\"objectSpread2\",\"asyncToGenerator\",\"tf\",\"Appvue_type_script_lang_js_\",\"ctx\",\"imgWorld\",\"worldLoaded\",\"fpsCounter\",\"tick\",\"tickTime\",\"duration\",\"x\",\"y\",\"speed\",\"steeringSpeed\",\"angle\",\"viewReduction\",\"viewReducedSize\",\"viewPixels\",\"steering\",\"samples\",\"samplesMaxLength\",\"trainingSamplesMaxLength\",\"badRewards\",\"badRewardsInARow\",\"highscoresMaxLength\",\"highscoresMaxShown\",\"training\",\"undefined\",\"numberOfModels\",\"computed\",\"reducedSize\",\"highscoresShown\",\"mounted\",\"$refs\",\"canvas\",\"getContext\",\"Image\",\"src\",\"onload\",\"ctxViewSnapshot\",\"viewSnapshotCanvas\",\"ctxCarSnapshot\",\"carSnapshotCanvas\",\"ctxCar\",\"carCanvas\",\"ctxView\",\"viewCanvas\",\"ctxViewReduced\",\"viewCanvasReduced\",\"ctxStats\",\"statsCanvas\",\"Array\",\"createModel\",\"refreshLoop\",\"methods\",\"console\",\"log\",\"numberOfLayers\",\"layers\",\"Math\",\"ceil\",\"random\",\"round\",\"children\",\"sequential\",\"_i\",\"add\",\"dense\",\"inputShape\",\"compile\",\"loss\",\"optimizer\",\"train\",\"rmsprop\",\"metrics\",\"_this\",\"regeneratorRuntime\",\"mark\",\"_callee\",\"highscoreOfModel\",\"_highscoreOfModel\",\"highscoreIndex\",\"mother\",\"_this$trainingSamples\",\"featureValuesTraining\",\"labelValuesTraining\",\"_i2\",\"featureValueTraining\",\"featureTensorTraining\",\"labelTensorTraining\",\"wrap\",\"_context\",\"prev\",\"next\",\"find\",\"el\",\"reward\",\"sort\",\"state\",\"action\",\"tensor2d\",\"trainModel\",\"min\",\"stop\",\"epochs\",\"_this2\",\"_callee2\",\"_context2\",\"abrupt\",\"fit\",\"callbacks\",\"onEpochEnd\",\"epoch\",\"onTrainEnd\",\"predict\",\"input\",\"_this3\",\"_callee3\",\"_context3\",\"tidy\",\"inputTensor\",\"outputTensor\",\"outputValue\",\"dataSync\",\"getSteering\",\"_this4\",\"_callee4\",\"_context4\",\"testingDataInput\",\"prediction\",\"sent\",\"max\",\"_this5\",\"requestAnimationFrame\",\"now\",\"performance\",\"date\",\"Date\",\"setSeconds\",\"toISOString\",\"substr\",\"enterFrame\",\"drawWorld\",\"getView\",\"moveCar\",\"drawStats\",\"clearRect\",\"numberOfsamplesDrawn\",\"beginPath\",\"fillStyle\",\"arc\",\"actionPredicted\",\"PI\",\"fill\",\"rgb\",\"toString\",\"then\",\"steeringPredicted\",\"randomisation\",\"randomisedValue\",\"steeringStrength\",\"_steeringStrength\",\"sin\",\"cos\",\"checkCarCollision\",\"viewX\",\"viewY\",\"snapshotWhereViewIs\",\"getImageData\",\"viewSnapshotPixels\",\"g\",\"b\",\"save\",\"translate\",\"rotate\",\"pixelIndex\",\"color\",\"rgbToHex\",\"fillRect\",\"restore\",\"imgWhereViewIs\",\"putImageData\",\"_i3\",\"_r\",\"_g\",\"_b\",\"previousTotalBrightness\",\"viewPixelsReduced\",\"_i4\",\"reducePixels\",\"sqrt\",\"_y\",\"_x\",\"_pixelIndex\",\"_color\",\"unshift\",\"totalBrightness\",\"_i5\",\"brightness\",\"brightnessChange\",\"abs\",\"snapshotWhereCarIs\",\"carSnapshotPixels\",\"imgWhereCarIs\",\"drawCarAndViewSquare\",\"totalR\",\"totalG\",\"totalB\",\"_i6\",\"resetCar\",\"a\",\"strokeStyle\",\"rect\",\"stroke\",\"componentToHex\",\"hex\",\"pixels\",\"size\",\"pixelsReduced\",\"pixelIndexes\",\"drawImage\",\"src_Appvue_type_script_lang_js_\",\"componentNormalizer\",\"component\",\"App\",\"config\",\"productionTip\",\"render\",\"h\",\"$mount\",\"5c0b\",\"6\",\"7\",\"8\",\"9c0c\",\"dfef\"],\"mappings\":\"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\"}","code":"(function(t){function e(e){for(var i,r,h=e[0],c=e[1],o=e[2],d=0,g=[];d<h.length;d++)r=h[d],Object.prototype.hasOwnProperty.call(a,r)&&a[r]&&g.push(a[r][0]),a[r]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(t[i]=c[i]);l&&l(e);while(g.length)g.shift()();return n.push.apply(n,o||[]),s()}function s(){for(var t,e=0;e<n.length;e++){for(var s=n[e],i=!0,h=1;h<s.length;h++){var c=s[h];0!==a[c]&&(i=!1)}i&&(n.splice(e--,1),t=r(r.s=s[0]))}return t}var i={},a={app:0},n=[];function r(e){if(i[e])return i[e].exports;var s=i[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,r),s.l=!0,s.exports}r.m=t,r.c=i,r.d=function(t,e,s){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},r.r=function(t){\"undefined\"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(t,\"__esModule\",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&\"object\"===typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(r.r(s),Object.defineProperty(s,\"default\",{enumerable:!0,value:t}),2&e&&\"string\"!=typeof t)for(var i in t)r.d(s,i,function(e){return t[e]}.bind(null,i));return s},r.n=function(t){var e=t&&t.__esModule?function(){return t[\"default\"]}:function(){return t};return r.d(e,\"a\",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p=\"/selfdriving/\";var h=window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[],c=h.push.bind(h);h.push=e,h=h.slice();for(var o=0;o<h.length;o++)e(h[o]);var l=c;n.push([0,\"chunk-vendors\"]),s()})({0:function(t,e,s){t.exports=s(\"56d7\")},1:function(t,e){},2:function(t,e){},3:function(t,e){},4:function(t,e){},5:function(t,e){},\"56d7\":function(t,e,s){\"use strict\";s.r(e);s(\"e260\"),s(\"e6cf\"),s(\"cca6\"),s(\"a79d\");var i=s(\"2b0e\"),a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s(\"div\",{attrs:{id:\"app\"}},[s(\"div\",{staticClass:\"world\"},[s(\"canvas\",{ref:\"canvas\",staticClass:\"world-canvas\",attrs:{width:t.worldWidth,height:t.worldHeight}}),t.training?s(\"div\",{staticClass:\"training\"},[s(\"span\",[t._v(\"TRAINING\"),s(\"br\"),t._v(t._s(t.trainingProgress)+\"% (\"+t._s(t.trainingSamples.length)+\")\")])]):t._e()]),s(\"canvas\",{ref:\"carSnapshotCanvas\",staticClass:\"car-snapshot-canvas\",attrs:{width:1.5*t.car.length,height:1.5*t.car.length}}),s(\"canvas\",{ref:\"viewSnapshotCanvas\",staticClass:\"view-snapshot-canvas\",attrs:{width:1.5*t.viewSize,height:1.5*t.viewSize}}),s(\"canvas\",{ref:\"carCanvas\",staticClass:\"car-canvas\",attrs:{width:t.car.width,height:t.car.length}}),s(\"canvas\",{ref:\"viewCanvas\",staticClass:\"view-canvas\",attrs:{width:t.viewSize,height:t.viewSize}}),s(\"canvas\",{ref:\"viewCanvasReduced\",staticClass:\"view-canvas-reduced\",attrs:{width:t.reducedViewSize,height:t.reducedViewSize}}),s(\"span\",{staticClass:\"fps\"},[t._v(t._s(t.fps)+\" fps\")]),s(\"div\",{staticClass:\"highscores\"},[s(\"div\",{staticClass:\"duration\"},[s(\"label\",[t._v(\"Total Duration\")]),t._v(\" \"+t._s(t.durationString)+\" \")]),s(\"label\",[t._v(\"Highscores (\"+t._s(t.highscores.length)+\")\")]),s(\"ul\",t._l(t.highscoresShown,(function(e,i){return s(\"li\",{key:i},[s(\"b\",[t._v(t._s(t.models[e.modelIndex].name)+\" - \")]),t._v(\" \"+t._s(e.score))])})),0)]),s(\"div\",{staticClass:\"score\"},[s(\"div\",{staticClass:\"current\"},[s(\"label\",[t._v(\"Current Score\")]),t._v(\" \"+t._s(t.score)+\" \")]),s(\"div\",{staticClass:\"last\"},[s(\"label\",[t._v(\"Last Score\")]),t._v(\" \"+t._s(t.lastScore)+\" \")])]),s(\"div\",{staticClass:\"stats\"},[s(\"canvas\",{ref:\"statsCanvas\",staticClass:\"stats-canvas\",attrs:{width:40,height:500}})]),s(\"div\",{staticClass:\"models\"},[s(\"label\",[t._v(\"Drivers\")]),s(\"ul\",t._l(t.models,(function(e,i){return s(\"li\",{key:i,class:{active:i===t.modelIndex}},[e?[t._v(\" \"+t._s(e.name)+\" \"),s(\"span\",{staticClass:\"layers\"},[t._v(\" [ \"),t._l(e.layers,(function(e){return[t._v(t._s(e.units)+\" \"+t._s(e.activation)+\", \")]})),t._v(\" ] \")],2),t._v(t._s(e.highscore||\"–\")+\" (t: \"+t._s(e.trainings)+\") \")]:t._e()],2)})),0)])])},n=[],r=s(\"2909\"),h=s(\"5530\"),c=s(\"1da1\"),o=(s(\"96cf\"),s(\"fb6a\"),s(\"7db0\"),s(\"d3b7\"),s(\"b0c0\"),s(\"4e82\"),s(\"cb29\"),s(\"25f0\"),s(\"ce1a\")),l={name:\"App\",data:function(){return{ctx:null,worldWidth:256,worldHeight:256,imgWorld:null,worldLoaded:!1,fps:null,fpsCounter:null,tick:!0,tickTime:null,duration:-1,durationString:null,car:{width:8,length:16,x:32,y:192,speed:.5,steeringSpeed:.025,angle:0},viewSize:32,viewReduction:4,viewReducedSize:null,viewPixels:null,steering:null,samples:[],samplesMaxLength:4096,trainingSamples:null,trainingSamplesMaxLength:4096,badRewards:0,badRewardsInARow:0,score:0,lastScore:null,highscores:[],highscoresMaxLength:10,highscoresMaxShown:10,training:!1,trainingProgress:0,models:void 0,numberOfModels:5,modelIndex:0}},computed:{reducedViewSize:function(){for(var t=this.viewSize,e=0;e<this.viewReduction;e++)t/=2;return t},highscoresShown:function(){return this.highscores.slice(0,this.highscoresMaxShown)}},mounted:function(){this.ctx=this.$refs.canvas.getContext(\"2d\"),this.imgWorld=new Image(this.worldWidth,this.worldHeight),this.imgWorld.src=s(\"dfef\");var t=this;this.imgWorld.onload=function(){t.worldLoaded=!0},this.ctxViewSnapshot=this.$refs.viewSnapshotCanvas.getContext(\"2d\"),this.ctxCarSnapshot=this.$refs.carSnapshotCanvas.getContext(\"2d\"),this.ctxCar=this.$refs.carCanvas.getContext(\"2d\"),this.ctxView=this.$refs.viewCanvas.getContext(\"2d\"),this.ctxViewReduced=this.$refs.viewCanvasReduced.getContext(\"2d\"),this.ctxStats=this.$refs.statsCanvas.getContext(\"2d\"),this.viewReducedSize=this.viewSize;for(var e=0;e<this.viewReduction;e++)this.viewReducedSize=this.viewReducedSize/2;this.models=new Array(this.numberOfModels),this.createModel(this.modelIndex),this.refreshLoop()},methods:{createModel:function(t){console.log(\"creating model ...\");for(var e=2,s=new Array(e),i=e-1;i>=0;i--)s[i]=i===e-1?{units:1,activation:\"sigmoid\"}:{units:3+Math.ceil(15*Math.random()),activation:[\"relu\",\"sigmoid\"][Math.round(Math.random())]};this.models[t]={layers:s,trainings:0,highscore:void 0,name:t+1,children:0},this.models[t].model=o.sequential();for(var a=0;a<s.length;a++)0===a?this.models[t].model.add(o.layers.dense({inputShape:this.viewReducedSize*this.viewReducedSize,activation:s[a].activation,units:s[a].units})):this.models[t].model.add(o.layers.dense({activation:s[a].activation,units:s[a].units}));this.models[t].model.compile({loss:\"binaryCrossentropy\",optimizer:o.train.rmsprop(.1),metrics:[\"accuracy\"]})},train:function(){var t=this;return Object(c[\"a\"])(regeneratorRuntime.mark((function e(){var s,i,a,n,c,l,d,g,u,v,p,w,x,m,f;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:for(s=t.highscores.find((function(e){return e.modelIndex===t.modelIndex})),s&&(t.models[t.modelIndex].highscore=s.score),t.modelIndex=(t.modelIndex+1)%t.numberOfModels,t.models[t.modelIndex]?(i=t.highscores.find((function(e){return e.modelIndex===t.modelIndex})),i||(a=Math.random(),a>1-.182?n=0:a>.655?n=1:a>.509?n=2:a>.382?n=3:a>.273?n=4:a>.273-.091?n=5:a>.273-.091-.073?n=6:a>.05500000000000003?n=7:a>.01800000000000003?n=8:a>3122502256758253e-32&&(n=9),c=t.models[t.highscores[n].modelIndex],t.models[t.modelIndex]=Object(h[\"a\"])({},c),t.models[t.modelIndex].trainings=0,t.models[t.modelIndex].highscore=void 0,c.children++,t.models[t.modelIndex].name=c.name+\".\"+c.children)):t.createModel(t.modelIndex),t.training=!0,t.trainingSamples=[],l=0;l<t.highscores.length;l++){for(g=[],u=0;u<t.highscores[l].samples.length;u++)t.highscores[l].samples[u].reward>.5&&g.push(t.highscores[l].samples[u]);(d=t.trainingSamples).push.apply(d,g)}for(t.trainingSamples.sort((function(){return.5-Math.random()})),t.trainingSamples=t.trainingSamples.slice(0,t.trainingSamplesMaxLength),console.log(\"total number of samples: \"+t.trainingSamples.length),v=[],p=[],w=0;w<t.trainingSamples.length;w++)x=Object(r[\"a\"])(t.trainingSamples[w].state),v.push(x),p.push(t.trainingSamples[w].action);return m=o.tensor2d(v,[v.length,v[0].length]),f=o.tensor2d(p,[p.length,1]),console.log(\"train model ...\"),e.next=18,t.trainModel(t.modelIndex,m,f,10*Math.min(10,t.trainingSamplesMaxLength/t.trainingSamples.length));case 18:t.training=!1,t.trainingProgress=0,t.models[t.modelIndex].trainings+=1;case 21:case\"end\":return e.stop()}}),e)})))()},trainModel:function(t,e,s,i){var a=this;return Object(c[\"a\"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=a,n.abrupt(\"return\",a.models[t].model.fit(e,s,{epochs:i,callbacks:{onEpochEnd:function(t){r.trainingProgress=Math.round(t/i*100)},onTrainEnd:function(){console.log(\"done\")}}}));case 2:case\"end\":return n.stop()}}),n)})))()},predict:function(t,e){var s=this;return Object(c[\"a\"])(regeneratorRuntime.mark((function i(){return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.abrupt(\"return\",o.tidy((function(){var i=o.tensor2d([e],[1,s.viewReducedSize*s.viewReducedSize]),a=s.models[t].model.predict(i),n=a.dataSync();return n})));case 1:case\"end\":return i.stop()}}),i)})))()},getSteering:function(){var t=this;return Object(c[\"a\"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.predict(t.modelIndex,t.testingDataInput);case 2:return t.prediction=e.sent,t.prediction=Math.max(0,t.prediction),e.abrupt(\"return\",t.prediction);case 5:case\"end\":return e.stop()}}),e)})))()},refreshLoop:function(){var t=this;window.requestAnimationFrame((function(){var e=performance.now();if(t.tick){t.tickTime=e,t.fps=t.fpsCounter,t.fpsCounter=0,t.tick=!1,t.duration++;var s=new Date(0);s.setSeconds(t.duration),t.durationString=s.toISOString().substr(11,8)}else t.fpsCounter++,e>=t.tickTime+1e3&&(t.tick=!0);t.enterFrame(),t.refreshLoop()}))},enterFrame:function(){this.worldLoaded&&!this.training&&(this.drawWorld(),this.getView(),this.moveCar())},drawStats:function(){this.ctxStats.clearRect(0,0,this.ctxStats.canvas.width,this.ctxStats.canvas.height);for(var t=Math.min(512,this.samples.length),e=0;e<t;e++){this.ctxStats.beginPath(),this.ctxStats.fillStyle=\"#ffffff\",this.ctxStats.arc(this.samples[e].actionPredicted*this.ctxStats.canvas.width,this.ctxStats.canvas.height/t*e,1,0,2*Math.PI),this.ctxStats.fill(),this.ctxStats.beginPath();var s=void 0;this.samples[e].reward>=.5?(s=\"#00\"+Math.round(255*this.samples[e].reward).toString(16)+\"00\",this.ctxStats.fillStyle=s,this.ctxStats.arc(this.samples[e].action*this.ctxStats.canvas.width,this.ctxStats.canvas.height/t*e,1,0,2*Math.PI),this.ctxStats.fill()):(s=\"#\"+Math.round(255*(1-this.samples[e].reward)).toString(16)+\"0000\",this.ctxStats.fillStyle=s,this.ctxStats.arc(this.samples[e].action*this.ctxStats.canvas.width,this.ctxStats.canvas.height/t*e,1,0,2*Math.PI),this.ctxStats.fill())}},moveCar:function(){this.testingDataInput=Object(r[\"a\"])(this.viewPixels);var t=this;this.getSteering().then((function(e){e=Math.min(e,1),e=Math.max(e,0),t.car.steeringPredicted=e;var s=0;s=t.samples[0]?t.samples[0].reward<.5?Math.min(1,t.badRewards/t.samples.length*t.badRewardsInARow):.05:1;var i=Math.random(),a=e-1*s+i*s*2;if(a=Math.min(a,1),a=Math.max(a,0),t.car.steering=a,t.car.steering<.5){var n=2*(.5-t.car.steering);t.car.angle-=t.car.steeringSpeed*n}else if(t.car.steering>.5){var r=2*(t.car.steering-.5);t.car.angle+=t.car.steeringSpeed*r}t.car.x+=Math.sin(t.car.angle)*t.car.speed,t.car.y-=Math.cos(t.car.angle)*t.car.speed,t.checkCarCollision()}))},getView:function(){this.car.viewX=this.car.x+Math.sin(this.car.angle)*(0*this.car.length+this.viewSize/2),this.car.viewY=this.car.y-Math.cos(this.car.angle)*(0*this.car.length+this.viewSize/2),this.snapshotWhereViewIs=this.ctx.getImageData(this.car.viewX-this.ctxViewSnapshot.canvas.width/2,this.car.viewY-this.ctxViewSnapshot.canvas.height/2,this.ctxViewSnapshot.canvas.width,this.ctxViewSnapshot.canvas.height);for(var t=[],e=0;e<this.snapshotWhereViewIs.data.length;e+=4){var s=this.snapshotWhereViewIs.data[e],i=this.snapshotWhereViewIs.data[e+1],a=this.snapshotWhereViewIs.data[e+2];t.push([s,i,a])}this.ctxViewSnapshot.save(),this.ctxViewSnapshot.clearRect(0,0,this.ctxViewSnapshot.canvas.width,this.ctxViewSnapshot.canvas.height),this.ctxViewSnapshot.translate(this.ctxViewSnapshot.canvas.width/2,this.ctxViewSnapshot.canvas.height/2),this.ctxViewSnapshot.rotate(-this.car.angle),this.ctxViewSnapshot.translate(-this.ctxViewSnapshot.canvas.width/2,-this.ctxViewSnapshot.canvas.height/2);for(var n=0;n<this.ctxViewSnapshot.canvas.height;n++)for(var r=0;r<this.ctxViewSnapshot.canvas.width;r++){var h=n*this.ctxViewSnapshot.canvas.width+r,c=this.rgbToHex(t[h][0],t[h][1],t[h][2]);this.ctxViewSnapshot.fillStyle=c,this.ctxViewSnapshot.fillRect(r,n,1.5,1.5)}this.ctxViewSnapshot.restore(),this.imgWhereViewIs=this.ctxViewSnapshot.getImageData(this.ctxViewSnapshot.canvas.width/2-this.ctxView.canvas.width/2,this.ctxViewSnapshot.canvas.height/2-this.ctxView.canvas.height/2,this.ctxView.canvas.width,this.ctxView.canvas.height),this.ctxView.putImageData(this.imgWhereViewIs,0,0);for(var o=[],l=0;l<this.imgWhereViewIs.data.length;l+=4){var d=this.imgWhereViewIs.data[l],g=this.imgWhereViewIs.data[l+1],u=this.imgWhereViewIs.data[l+2];o.push([d,g,u])}for(var v,p=o,w=0;w<this.viewReduction;w++)p=this.reducePixels(p,Math.sqrt(p.length));for(var x=0;x<this.ctxViewReduced.canvas.height;x++)for(var m=0;m<this.ctxViewReduced.canvas.width;m++){var f=x*this.ctxViewReduced.canvas.width+m,S=this.rgbToHex(p[f][0],p[f][1],p[f][2]);this.ctxViewReduced.fillStyle=S,this.ctxViewReduced.fillRect(m,x,1.5,1.5)}this.viewPixels&&(this.samples.unshift({state:this.viewPixels,action:this.car.steering,actionPredicted:this.car.steeringPredicted}),v=this.totalBrightness),this.viewPixels=[],this.totalBrightness=0;for(var C=0;C<p.length;C++){var b=(p[C][0]+p[C][1]+p[C][2])/765;this.viewPixels.push(b),this.totalBrightness+=b}if(this.totalBrightness=this.totalBrightness/this.viewPixels.length,this.samples.length){var I,M=this.totalBrightness-v;console.log(\"---\"),M>=0?I=this.totalBrightness>.5?1:.75+Math.min(.25,10*M*this.totalBrightness):(I=this.totalBrightness<.5?0:Math.min(.25,10*Math.abs(M)*this.totalBrightness),I=0),this.samples[0].reward=I,I<.5?(this.badRewards++,this.badRewardsInARow++):this.badRewardsInARow=0,this.samples.length===this.samplesMaxLength&&(this.samples[this.samples.length-1].reward<.5&&this.badRewards--,this.samples=this.samples.slice(0,this.samplesMaxLength-1)),console.log(\"good samples: \"+(this.samples.length-this.badRewards)+\" of \"+this.samples.length)}else this.badRewards=0,this.badRewardsInARow=0},checkCarCollision:function(){this.snapshotWhereCarIs=this.ctx.getImageData(this.car.x-this.ctxCarSnapshot.canvas.width/2,this.car.y-this.ctxCarSnapshot.canvas.height/2,this.ctxCarSnapshot.canvas.width,this.ctxCarSnapshot.canvas.height);for(var t=[],e=0;e<this.snapshotWhereCarIs.data.length;e+=4){var s=this.snapshotWhereCarIs.data[e],i=this.snapshotWhereCarIs.data[e+1],a=this.snapshotWhereCarIs.data[e+2];t.push([s,i,a])}this.ctxCarSnapshot.save(),this.ctxCarSnapshot.clearRect(0,0,this.ctxCarSnapshot.canvas.width,this.ctxCarSnapshot.canvas.height),this.ctxCarSnapshot.translate(this.ctxCarSnapshot.canvas.width/2,this.ctxCarSnapshot.canvas.height/2),this.ctxCarSnapshot.rotate(-this.car.angle),this.ctxCarSnapshot.translate(-this.ctxCarSnapshot.canvas.width/2,-this.ctxCarSnapshot.canvas.height/2);for(var n=0;n<this.ctxCarSnapshot.canvas.height;n++)for(var h=0;h<this.ctxCarSnapshot.canvas.width;h++){var c=n*this.ctxCarSnapshot.canvas.width+h,o=this.rgbToHex(t[c][0],t[c][1],t[c][2]);this.ctxCarSnapshot.fillStyle=o,this.ctxCarSnapshot.fillRect(h,n,1.5,1.5)}this.ctxCarSnapshot.restore(),this.imgWhereCarIs=this.ctxCarSnapshot.getImageData(this.ctxCarSnapshot.canvas.width/2-this.ctxCar.canvas.width/2,this.ctxCarSnapshot.canvas.height/2-this.ctxCar.canvas.height/2,this.ctxCar.canvas.width,this.ctxCar.canvas.height),this.ctxCar.putImageData(this.imgWhereCarIs,0,0),this.drawCarAndViewSquare();for(var l=0,d=0,g=0,u=0;u<this.imgWhereCarIs.data.length;u+=4)l+=this.imgWhereCarIs.data[u],d+=this.imgWhereCarIs.data[u+1],g+=this.imgWhereCarIs.data[u+2];l=Math.round(l/(this.imgWhereCarIs.data.length/4)),d=Math.round(d/(this.imgWhereCarIs.data.length/4)),g=Math.round(g/(this.imgWhereCarIs.data.length/4)),l+d+g<760?(console.log(\"collision!\"),this.viewPixels=null,this.car.steering=void 0,this.resetCar(),(this.highscores.length<this.highscoresMaxLength||this.score>this.highscores[this.highscoresMaxLength-1].score)&&(console.log(\"new highscore\"),this.highscores.push({score:this.score,samples:Object(r[\"a\"])(this.samples),modelIndex:this.modelIndex}),this.highscores.sort((function(t,e){return e.score-t.score})),this.highscores=this.highscores.slice(0,this.highscoresMaxLength)),console.log(\"train\"),this.train(),this.drawStats(),this.samples=[],this.lastScore=this.score,this.score=0):(this.score++,this.drawStats())},drawCarAndViewSquare:function(){this.ctx.save(),this.ctx.translate(this.car.x,this.car.y),this.ctx.rotate(this.car.angle),this.ctx.translate(-this.car.x,-this.car.y),this.ctx.fillRect(this.car.x-this.car.width/2,this.car.y-this.car.length/2,this.car.width,this.car.length),this.ctx.restore(),this.ctx.save(),this.ctx.translate(this.car.viewX,this.car.viewY),this.ctx.rotate(this.car.angle),this.ctx.translate(-this.car.viewX,-this.car.viewY),this.ctx.strokeStyle=\"#ff0000\",this.ctx.beginPath(),this.ctx.rect(this.car.viewX-this.ctxView.canvas.width/2,this.car.viewY-this.ctxView.canvas.height/2,this.ctxView.canvas.width,this.ctxView.canvas.height),this.ctx.stroke(),this.ctx.restore()},componentToHex:function(t){var e=t.toString(16);return 1==e.length?\"0\"+e:e},rgbToHex:function(t,e,s){return\"#\"+this.componentToHex(t)+this.componentToHex(e)+this.componentToHex(s)},reducePixels:function(t,e){for(var s=[],i=0;i<e;i+=2)for(var a=0;a<e;a+=2){for(var n=[i*e+a,i*e+a+1,(i+1)*e+a,(i+1)*e+a+1],r=0,h=0,c=0,o=0;o<n.length;o++)r+=t[n[o]][0],h+=t[n[o]][1],c+=t[n[o]][2];r=Math.round(r/n.length),h=Math.round(h/n.length),c=Math.round(c/n.length),s.push([r,h,c])}return s},drawWorld:function(){this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.drawImage(this.imgWorld,0,0,this.ctx.canvas.width,this.ctx.canvas.height)},resetCar:function(){console.log(\"reset car\"),this.car.x=this.worldWidth/2*.25,this.car.y=this.worldHeight/2*1.5,this.car.angle=0}}},d=l,g=(s(\"5c0b\"),s(\"2877\")),u=Object(g[\"a\"])(d,a,n,!1,null,null,null),v=u.exports;i[\"a\"].config.productionTip=!1,new i[\"a\"]({render:function(t){return t(v)}}).$mount(\"#app\")},\"5c0b\":function(t,e,s){\"use strict\";s(\"9c0c\")},6:function(t,e){},7:function(t,e){},8:function(t,e){},\"9c0c\":function(t,e,s){},dfef:function(t,e,s){t.exports=s.p+\"img/world4.00d00251.jpg\"}});","extractedComments":[]}